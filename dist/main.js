!function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var s=function(e,t,r=!1){if(""==t)return e;var s=r?e.lastIndexOf(t):e.indexOf(t);return-1===s?e:e.substr(0,s)},n=function(e){return Array.isArray(e)},i=function(e){return"string"==typeof e},a=function(e){return arguments.length&&(void 0===e||void 0===e)},o=function(e){return null===e||""===e},l=function(e){return Array.isArray(e)||"object"==typeof e},p=function(e){return!Array.isArray(e)&&"object"==typeof e&&e},c=function(e){return n(e)?e:!1!==e&&0!==e&&function(e){return o(e)||a(e)||!1===e||0===e||l(e)&&!Object.keys(e).length}(e)?[]:function(e){return!i(e)&&!a(e.length)}(e)?Array.prototype.slice.call(e):p(e)?Object.values(e):[e]},h=function(e,...t){return t.forEach(t=>{e.indexOf(t)<0&&e.push(t)}),e},u=function(e,t,r=null){return n(t)?e.filter(e=>r?t.filter(t=>r(e,t)).length:-1!==t.indexOf(e)):[]};const m={std:{html:{type:["#sectioning-root"],model:["head","body"],singleton:!0},caption:{model:["#flow","!table"],singleton:!0},col:{model:["#nothing"]},colgroup:{model:[{"colgroup[span]":["#nothing"]},{":not(colgroup[span])":["col","template"]}],singleton:!0},dd:{model:["#flow"],implicitRole:"definition"},dt:{model:["#flow","!#heading","!#sectioning","!header","!footer"],implicitRole:"term"},figcaption:{model:["#flow"],singleton:!0},head:{model:["#metadata"],singleton:!0},legend:{model:["#phrasing"],singleton:!0},li:{model:["#flow"],implicitRole:"listitem"},optgroup:{model:["option","#script-supporting"],implicitRole:"group"},option:{model:[{"option[label][value]":["#nothing"]},{"option[label]:not(option[value])":["#text"]},{":not(option[label])":["#text"]}]},param:{model:["#nothing"]},rp:{model:["#text"]},rt:{model:["#phrasing"]},source:{model:["#nothing"]},summary:{model:["#phrasing","#heading"],singleton:!0},track:{model:["#nothing"]},tbody:{model:["#script-supporting","tr"]},td:{model:["#flow","!#heading","!#sectioning","!header","!footer"]},tfoot:{model:["tr","#script-supporting"],singleton:!0},thead:{model:["tr","#script-supporting"],singleton:!0},tr:{model:["#script-supporting","td","th"]},a:{type:["#flow","#phrasing",{"a[href]":["#interactive","#palpable"]}],model:["#transparent","!#interactive","!a"]},abbr:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},address:{type:["#flow","#palpable"],model:["#flow","!#heading","!#sectioning","!header","!footer","!address"]},area:{type:["#flow","#phrasing"],model:["#nothing"]},article:{type:["#flow","#palpable","#sectioning-content"],model:["#flow"],implicitRole:"article",acceptableRoles:["application","article","document","main"]},aside:{type:["#flow","#palpable","#sectioning-content"],model:["#flow"],implicitRole:"complementary",acceptableRoles:["complementary","note","search"]},audio:{type:["#embedded","#flow","#phrasing",{"audio[controls]":["#interactive","#palpable"]}],model:["#transparent","!#media","track",{":not(audio[src])":["source"]}]},b:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},base:{type:["#metadata"],model:["#nothing"],singleton:!0},bdi:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},bdo:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},blockquote:{type:["#flow","#palpable","#sectioning-root"],model:["#flow"]},body:{type:["#sectioning-root"],model:["#flow","@banner","@contentinfo","@complementary","@main"],singleton:!0},br:{type:["#flow","#phrasing"],model:["#nothing"]},button:{type:["#flow","#interactive","#palpable","#phrasing"],model:["#phrasing","!#interactive"]},canvas:{type:["#embedded","#flow","#palpable","#phrasing"],model:["#transparent","!#interactive","a","img[usemap]","button",'input[type="button"]','input[type="radio"]','input[type="checkbox"]',"select[multiple]","select[size>=1]","[tabindex]!#interactive"]},cite:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},code:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},data:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},datalist:{type:["#flow","#phrasing"],model:["#phrasing","#script-supporting","option"]},del:{type:["#flow","#phrasing"],model:["#transparent"]},details:{type:["#flow","#interactive","#palpable","#sectioning-root"],model:["#flow","summary"]},dfn:{type:["#flow","#palpable","#phrasing"],model:["#phrasing","!dfn"],implicitRole:"term"},dialog:{type:["#flow","#sectioning-root"],model:["#flow"],implicitRole:"dialog"},div:{type:["#flow","#palpable"],model:[{"dl > div":["dt","dd"]},{":not(dl > div)":["#flow"]}]},dl:{type:["#flow"],model:["#script-supporting","dl","dt","div"]},em:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},embed:{type:["#embedded","#flow","#phrasing","#interactive","#palpable"],model:["#nothing"]},fieldset:{type:["#flow","#sectioning-root","#palpable"],model:["legend","#flow"]},figure:{type:["#flow","#sectioning-root","#palpable"],model:["#flow","figcaption"],implicitRole:"figure"},footer:{type:["#flow","#palpable"],model:["#flow","!header","!footer"],acceptableRoles:["contentinfo"],singleton:!0},form:{type:["#flow","#palpable"],model:["#flow","!form"]},h1:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h2:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h3:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h4:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h5:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h6:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},header:{type:["#flow","#palpable"],model:["#flow","!header","!footer"],acceptableRoles:["banner"],singleton:!0},hgroup:{type:["#flow","#heading","#palpable"],model:["h1","h2","h3","h4","h5","h6","#script-supporting"]},hr:{type:["#flow"],model:["#nothing"],implicitRole:"separator"},i:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},iframe:{type:["#embedded","#flow","#phrasing","#interactive","#palpable"],model:["#nothing"]},img:{type:["#embedded","#flow","#phrasing",{"img[usemap]":["#interactive","#palpable"]}],model:["#nothing"]},input:{type:["#flow","#phrasing",{'input:not([type!="hidden"])':["#interactive","#palpable"]}],model:["#nothing"]},ins:{type:["#flow","#phrasing","#palpable"],model:["#transparent"]},kbd:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},label:{type:["#flow","#phrasing","#interactive","#palpable"],model:["#phrasing","!label"]},link:{type:["#metadata",{"body link":["#flow","#phrasing"]}],model:["#nothing"]},main:{type:["#flow","#palpable"],model:["#flow"],implicitRole:"main",singleton:!0},map:{type:["#flow","#phrasing","#palpable"],model:["#transparent"]},mark:{type:["#flow","#phrasing","#palpable"],model:["#transparent"]},math:{type:["#embedded","#flow","#phrasing","#palpable"],model:[]},menu:{type:["#flow",{":contains(> li)":["#palpable"]}],model:["#script-supporting","li"],implicitRole:"list"},meta:{type:["#metadata",{"meta[itemprop]":["#flow","#phrasing"]}],model:["#nothing"],names:["application-name","author","description","generator","keywords","referrer","theme-color"]},meter:{type:["#flow","#labelable","#phrasing","#palpable"],model:["#phrasing","!meter"]},nav:{type:["#flow","#sectioning-content","#palpable"],model:["#flow"],implicitRole:"navigation",acceptableRoles:["navigation"]},noscript:{type:["#metadata","#flow","#phrasing"],model:[{"head link":["style","meta","link"]},{":not(head link)":["#transparent","!noscript"]}]},object:{type:["#embedded","#flow","#phrasing",{"object[usemap]":["#interactive","#palpable"]}],model:["#transparent","param"]},ol:{type:["#flow",{":contains(> li)":["#palpable"]}],model:["#script-supporting","li"],implicitRole:"list"},output:{type:["#flow","#labelable","#phrasing","#palpable"],model:["#phrasing","!meter"]},p:{type:["#flow","#palpable"],model:["#phrasing"]},picture:{type:["#embedded","#flow","#phrasing"],model:["source","img","#acript-supporting"]},pre:{type:["#flow","#palpable"],model:["#phrasing"]},progress:{type:["#flow","#labelable","#phrasing","#palpable"],model:["#phrasing","!progress"]},q:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},ruby:{type:["#flow","#phrasing","#palpable"],model:["rp","rt"]},s:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},samp:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},script:{type:["#flow","#metadata","#phrasing","#acript-supporting"],model:[{"script[src]":[]}]},section:{type:["#flow","#sectioning-content","#palpable"],model:["#flow"],implicitRole:"region",acceptableRoles:["alert","alertdialog","application","contentinfo","dialog","document","log","main","marquee","region","search","status"]},select:{type:["#flow","#interactive","#labelable","#phrasing","#palpable"],model:["option","optgroup","#acript-supporting"]},slot:{type:["#flow","#phrasing"],model:["#transparent"]},small:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},span:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},strong:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},style:{type:["#metadata"],model:["#text"]},sub:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},sup:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},svg:{type:["#embedded","#flow","#phrasing","#palpable"],model:[]},table:{type:["#flow","#palpable"],model:["caption","colgroup","thead","tbody","tr","tfoot","#script-supporting"]},td:{type:["#sectioning-root"],model:["#flow"]},template:{type:["#metadata","#flow","#phrasing","#script-supporting"],model:["#nothing"]},textarea:{type:["#flow","#interactive","#labelable","#phrasing","#palpable"],model:["#text"]},time:{type:["#flow","#phrasing","#palpable"],model:[{"time[datetime]":["#phrasing"]},{":not(time[datetime])":["#text"]}]},title:{type:["#metadata"],model:["#text"],singleton:!0},u:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},ul:{type:["#flow",{":contains(> li)":["#palpable"]}],model:["#script-supporting","li"],implicitRole:"list"},var:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},video:{type:["#embedded","#flow","#phrasing",{"video[controls]":["#interactive","#palpable"]}],model:["#transparent","!#media","track",{":not(video[src])":["source"]}]},wbr:{type:["#flow","#phrasing"],model:["#nothing"]}},aria:{banner:{type:["@banner"],singleton:!0},contentinfo:{type:["@contentinfo"],singleton:!0},complementary:{type:["@complementary"],singleton:!0},navigation:{type:["@navigation"],singleton:!0},list:{type:["@list"]},listitem:{type:["@listitem"]}},getContentModelFor(e){var t=e.nodeName.toLowerCase();return m.std[t]?m.expandRules(e,m.std[t].model||[]):[]},getCategoriesFor(e,t=!0){var r=e.nodeName.toLowerCase(),s=m.std[r]||m.aria[r]||{},n=[];if(t&&!e.nodeName.startsWith("#")&&(e.hasAttribute("role")||s.implicitRole))if(e.hasAttribute("role")){e.getAttribute("role").split(" ");e.getAttribute("role").split(" ").forEach(t=>{s&&s.acceptableRoles&&!s.acceptableRoles.includes(t)||(t=t.trim(),n.push("@"+t),m.aria[t]&&m.aria[t].type&&(n=n.concat(m.expandRules(e,m.aria[t].type||[]))))})}else s.implicitRole&&h(n,"@"+s.implicitRole,r);else n=h(m.expandRules(e,s.type||[]),r);return n},assertNodeBelongsInContentModel(e,t){var r,s=e instanceof HTMLElement?m.getContentModelFor(e):e,n=t instanceof HTMLElement?m.getCategoriesFor(t):t;return!u(s,["#nothing","#text"]).length&&(s.forEach(e=>{if(e.startsWith("!")){var t=e.substr(1);n.includes(t)&&(r=!1)}else!1!==r&&n.includes(e)&&(r=!0)}),r&&!0)},assertNodeBelongsInScopeAs(e,t,r=null){for(var s,n=m.getCategoriesFor(e),i=t;!s&&(i=i.parentNode);)u(n,m.getCategoriesFor(i)).length&&m.assertNodeBelongsInContentModel(i,r&&r.type||t)&&(s=i);return s===e},expandRules(e,t){var r=t.reduce((t,r)=>(p(r)?e.matches(Object.keys(r)[0])&&(t=t.concat(Object.values(r)[0])):t.push(r),t),[]);return r.includes("#sectioning-root")&&r.push("#sectioning-content"),r}};var d=m;const f=class{constructor(e,t,r,s=null){this.sources=c(e),this.namespace=c(t),this.getter=r,this.carry=s,this.collections={},this.value}enter(e){return e in this.collections||(this.collections[e]=new f(this.sources,this.namespace.concat(e),this.getter,this)),this.collections[e]}leave(){return this.carry}get(){if(!this.value){var e=this.namespace.slice(),t=this.carry?this.carry.get():null;this.sources.forEach((r,s)=>{(t=this.getter.call(null,r,e,t,s))&&(this.value=t)})}return this.value}find(e){for(var t,r,s=e.split("/"),n=this;(r=s.shift())&&(n=n.enter(r));)t=n;var i=t.get();if(i)return i.cloneNode(!0)}};var g=f,v=function(e,t,r=!1){for(var s=e.indexOf(t);s>-1&&(r||!1===r);)e.splice(s,1),r>0&&r--,s=e.indexOf(t);return e},b=function(e,t){if(!e)return!1;if(e instanceof t)return!0;var r=e=>{for(;e&&e!==Function.prototype;){if(e===t||e.prototypes&&e.prototypes.reduce((e,s)=>e||s===t||r(s),!1))return!0;e=Object.getPrototypeOf(e)}return!1};return r(e.constructor)},y=function(e){return function(e){return"function"==typeof e}(e)||e&&"[object function]"==={}.toString.call(e)},w=function(e){return!0===e||!1===e},x=function(e){return!0!==e&&!1!==e&&null!==e&&""!==e&&!isNaN(1*e)},$=function(e,t){var r=void 0;return l(e)&&Object.keys(e).forEach(s=>{!1!==r&&(r=t(x(s)?parseFloat(s):s,e[s]))}),r};const C=function(e,t,r=!0,s=1){if(n(e)&&n(t)&&e.length!==t.length||p(e)&&p(t)&&Object.keys(e).length!==Object.keys(t).length)return!1;var i=function(e,t,r=!0,s=!0,i=!1,a=!1){if(n(e)&&n(t)){var o=[],c=!0;return e.forEach(e=>{if(c){var h=!1;$(t,(t,i)=>{(!h||s&&l(e))&&(h=r(e,i),(n(h)&&!h.length||p(h)&&!Object.keys(h).length)&&(h=!1),l(h)&&s&&(e=h))}),l(h)?o.push(s?h:e):w(h)?i&&!h||!i&&h?o.push(e):a&&(c=!1):o.push(h)}}),o}if(p(e)&&p(t)){o={},c=!0;return Object.keys(e).forEach(h=>{if(c){var u=r(e[h],t[h]);(n(u)&&!u.length||p(u)&&!Object.keys(u).length)&&(u=!1),l(u)?o[h]=s?u:e[h]:w(u)?i&&!u||!i&&u?o[h]=e[h]:a&&(c=!1):o[h]=u}}),o}}(e,t,(e,t)=>s>0&&(n(e)&&n(t)||p(e)&&p(t))?C(e,t,r,s-1):y(r)?r(e,t):e===t===r,!1,!1,!0);return n(i)?i.length===e.length:p(i)?Object.keys(i).length===Object.keys(e).length:i};var E=C,j=class{even(e){return!(!p(e)||e.jsenType!==this.jsenType)&&E(e,this)}inherit(e){return this}withComments(e){return this.meta||(this.meta={}),this.meta.comments=e,this}withVars(e){return this.meta||(this.meta={}),this.meta.vars=e,this}};const O=class extends j{};Object.defineProperty(O.prototype,"jsenType",{get:()=>"AssignmentExpression"});var k=O;const S=class extends j{};Object.defineProperty(S.prototype,"jsenType",{get:()=>"Reference"});var A=S;const _=class extends j{};Object.defineProperty(_.prototype,"jsenType",{get:()=>"DeleteExpression"});var P=_;const R=class extends j{};Object.defineProperty(R.prototype,"jsenType",{get:()=>"CallExpression"});var N=R;const M=class{static parse(e,t,r={},s=M){if(r.meta||(r.meta={vars:[]}),e.length){for(var i=Object.values(t||s.grammars),a=0;a<i.length;a++){var o=r.meta&&n(r.meta.vars)?r.meta.vars.length:0,l=i[a].parse(e,(e,t)=>M.parse(e,t,r,s));if(l&&r.meta&&(l.meta||(l.meta={}),l.meta.vars=r.meta.vars.slice(o),(b(l,A)||b(l,N))&&(v(l.meta.vars,l.context),v(r.meta.vars,l.context),r.meta.vars.push(l))),l&&r.explain&&console.log(e," >>-------------\x3e> ",l.jsenType),(l instanceof k||l instanceof P)&&(!r||!r.mutates))throw new Error("[Permission error:] "+e);if(l)return l}if(!1===r.assert)return;throw new Error("[Syntax error:] "+e)}}};var T=M;const L=function(e,t=1,r=!0){return!x(t)||t<=0?e:(!n(e)&&p(e)&&r&&(e=Object.values(e)),n(e)?e.reduce((e,s)=>n(s)||p(s)&&r?e.concat(L(n(s)?s:Object.values(s),t-1,r)):e.concat(s),[]):e)};var H=L,F=function(e,t=1){var r=0;e.forEach(e=>{r++});var s=e.slice(e.length-r,t);return arguments.length>1?s:s[0]},W=function(e,t=1){return arguments.length>1?F(e.slice().reverse(),t).reverse():F(e.slice().reverse())},D=function(e,t){var r=[];return function(e,t){t=(t=t||Object.prototype)&&!n(t)?[t]:t;var r=[];for(e=e;e&&(!t||t.indexOf(e)<0)&&"default"!==e.name;)r.push(e),e=e?Object.getPrototypeOf(e):null;return r}(e,t).forEach(e=>{h(r,...Object.getOwnPropertyNames(e))}),r},q=function(e,t,r=!1,s=!1,i=!1){var a=0,o=e.shift();if((x(o)||!0===o||!1===o)&&(a=o,o=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach((e,c)=>{(l(e)||y(e))&&(r?D(e):Object.getOwnPropertyNames(e)).forEach(l=>{var h=o[l],u=e[l];if((n(h)&&n(u)||p(h)&&p(u))&&(!0===a||a>0))o[l]=n(h)&&n(u)?[]:{},q([x(a)?a-1:a,o[l],h,u],t,r,s);else if(t(l,o,e,c))if(n(o)&&n(e))s?o[l]=u:o.push(u);else if(i)Object.defineProperty(o,l,Object.getOwnPropertyDescriptor(e,l));else try{o[l]=e[l]}catch(e){}})}),o},B=function(...e){return q(e,(e,t,r)=>!0)},I=function(e,t=[]){return q([{},e],(e,r,s)=>{if(!y(s[e]))return y(t)?t(e):!n(t)||!t.length||t.indexOf(e)>-1},!1,!1,!1)};const Q=class{static lex(e,t,r){if(!i(e))throw new Error("Argument1 must be a string!");var s=new Q(e,r);return Q.$cache[e]=Q.$cache[e]||[],Q.$cache[e].push(s),s.lex(t)}static split(e,t,r){return Q.lex(e,t,r).tokens}static match(e,t,r){return Q.lex(e,t,r).matches}constructor(e,t){if(!i(e))throw new Error("Lexer requires the first argument to be a string.");this.$str=e,this.$options=t||{},this.$options.blocks||(this.$options.blocks=Q.$blocks),this.$options.quotes||(this.$options.quotes=Q.$quotes),this.$options.comments||(this.$options.comments=Q.$comments),this.$cache=[]}lex(e,t){var r={delims:c(e),options:B(!0,{},this.$options,t||{}),nesting:[],maxDepth:0,comments:[],tokens:[],matches:[],matchesi:{}};if(!1!==r.options.cache)for(var s=0;s<this.$cache.length;s++)if(E(this.$cache[s].delims,r.delims)&&E(this.$cache[s].options,r.options))return I(this.$cache[s]);if(this._evalCharsAt(r,0),r.nesting.length)throw new Error("Error parsing the string: "+this.$str+". Unterminated blocks: "+H(r.nesting).join(", "));return!1!==r.options.cache&&this.$cache.push(r),r}_evalCharsAt(e,t){if(!(t>=this.$str.length)){var r=1,s={},n={},i={};if(e.openComment||(n=this._testQuotes(e,t)),e.openQuote||(s=this._testComments(e,t)),e.openComment||s.ending)if(e.nesting.length||i.ending)this._push(e,this.$str[t]);else r=(o=s.starting||s.ending||this.$str[t]).length,this._push(e,o,"comments"),e.options.preserveComments&&this._push(e,o);else if(e.openQuote||n.ending)this._push(e,this.$str[t]);else{if(e.options.limit&&e.matches.length===e.options.limit)return this._push(e,this.$str[t]),this._evalCharsAt(e,t+1);i=this._testNesting(e,t);i=this._testNesting(e,t);var a=this._testChars(e.options.stopChars||[],e,t);if(!e.nesting.length&&!1!==a)return e.options.stopChar=a,void(e.options.stopCharForward=this.$str.substr(t));if(e.delims.length)if(e.nesting.length||i.ending){var o;r=(o=i.starting||i.ending||this.$str[t]).length,this._push(e,o)}else{this._push(e,"");var l=this._testChars(e.delims,e,t);if(!1!==l&&(e.matches.push(l),e.matchesi[t]=l,r=l.length||1,!e.options.preserveDelims))return this._evalCharsAt(e,t+(l.length||1));this._push(e,l||this.$str[t])}else 2===e.nesting.length&&i.starting?(e.matches.push(null),this._push(e,i.starting),r=i.starting.length):!e.nesting.length&&i.ending?(this._push(e,i.ending),r=i.ending.length,e.matches.push(null)):this._push(e,this.$str[t])}return this._evalCharsAt(e,t+r)}}_testQuotes(e,t){var r={};return(e.options.quotes||[]).forEach(s=>{this.$str.substr(t,1)===s&&(e.openQuote?s===e.openQuote&&(e.openQuote=!1,r.ending=s):(e.openQuote=s,r.starting=s))}),r}_testComments(e,t){var r={};return(e.options.comments||[]).forEach(s=>{if(e.openComment){if(W(s)===W(e.openComment)){var n;(n=this.$str.substr(t).match(new RegExp("^"+W(s))))&&(e.openComment=!1,r.ending=n[0])}}else(n=this.$str.substr(t).match(new RegExp("^"+F(s))))&&(e.openComment=s,r.starting=n[0])}),r}_testNesting(e,t){var r={};return(e.options.blocks||[]).forEach(s=>{var n=this.$str.substr(t).match(new RegExp("^"+F(s)));if(n)e.nesting=e.nesting.concat([s]),r.starting=n[0];else if(e.nesting.length&&W(s)===W(W(e.nesting))){var i=this.$str.substr(t).match(new RegExp("^"+W(s)));i&&(e.nesting=e.nesting.slice(0,-1),r.ending=i[0])}}),e.maxDepth=Math.max(e.maxDepth,e.nesting.length),r}_testChars(e,t,r){for(var s=0;s<e.length;s++){var n=e[s];if(t.options.useRegex){var i=this.$str.substr(r).match(new RegExp("^"+n,!0!==t.options.useRegex?t.options.useRegex:""));if(i)return i[0]}if(!t.options.ci&&this.$str.substr(r,n.length)===n||t.options.ci&&this.$str.substr(r,n.length).toLowerCase()===n.toLowerCase())return n}return!1}_push(e,t,r="tokens"){var s=e.matches.length;a(e[r][s])&&(e[r][s]=""),e[r][s]+=t}split(e,t,r){return this.lex(t,r).tokens}match(e,t,r){return this.lex(t,r).matches}regParse(e,t){return this.lex(e,B({useRegex:!0},t||{}))}regSplit(e,t){return this.regParse(e,t).tokens}regMatch(e,t){return this.regParse(e,t).matches}};Q.$blocks=[["\\(","\\)"],["\\[","\\]"],["\\{","\\}"]],Q.$quotes=['"',"'","`"],Q.$comments=[["\\/\\*","\\*\\/"],["\\/\\/","(\\r)?\\n"]],Q.$cache={};var U=Q,K=function(e){return p(e)&&(t=t=>y(e[t]),["observe","unobserve","get","set","has","del"].reduce((e,r)=>e&&t(r),!0));var t},z=function(e,t,r={},s=!0){t=c(t).slice();for(var n=e;!a(n)&&!o(n)&&t.length;){var i=t.shift(),p=s&&K(n);if(!(p?n.get(i):l(n)?i in n:n[i]))return void(r.exists=!1);n=p?n.get(i):n[i]}return r.exists=!0,n};class J extends Array{get(e,t=!0){for(var r=0;r<this.length;r++){var s=z(this[r],e);if(y(s)&&t)return s.bind(this[r]);if(!a(s))return s}}static create(e){return e instanceof J?e:e?new J(e):new J}}var V=J,Y=function(e,t,r){return e.startsWith(t)&&e.endsWith(r)},Z=function(e,t,r=!1){if(""==t)return e;var s=r?e.lastIndexOf(t):e.indexOf(t);return-1===s?"":e.substr(s+t.length)},G=function(e,t){return s(e,t,!0)},X=function(e,t,r){return G(Z(e,t),r)};const ee=class extends j{};Object.defineProperty(ee.prototype,"jsenType",{get:()=>"Abstraction"});var te=ee;const re=class extends te{constructor(e){super(),this.expr=e}eval(e=null,t=null){return this.expr.eval(e,t)}toString(e=null){return"("+this.expr.toString(e)+")"}static parse(e,t,r=re){if(Y(e,"(",")")&&!U.match(e,[" "]).length)return new r(t(X(e,"(",")")))}};var se=re;const ne=class extends j{};Object.defineProperty(ne.prototype,"jsenType",{get:()=>"ArrayType"});var ie=ne;const ae=class extends ie{constructor(e){super(),this.exprs=e||[]}inherit(e){if(e instanceof ie){var t=e.exprs.filter(e=>this.exprs.reduce((t,r)=>t&&!e.even(r),!0));this.exprs=t.concat(this.exprs)}return this}eval(e=null,t=null){return this.exprs.map(r=>r.eval(e,t))}toString(e=null){return"["+this.exprs.map(t=>t.toString(e)).join(", ")+"]"}static parse(e,t,r=ae){if(Y(e,"[","]")&&!U.match(e.trim(),[" "]).length)return new r(U.split(X(e,"[","]"),[","]).map(e=>e.trim()).filter(e=>e).map(e=>t(e)))}};var oe=ae;const le=class extends j{};Object.defineProperty(le.prototype,"jsenType",{get:()=>"Arguments"});var pe=le;const ce=class extends pe{constructor(e=[]){super(),this.list=e}eval(e=null,t=null){return this.list.map(r=>r.eval(e,t))}toString(e=null){return"("+this.list.map(t=>t.toString(e)).join(", ")+")"}static parse(e,t,r=ce){if(e=e.trim(),Y(e,"(",")")&&!U.match(e,[" "]).length)return new r(U.split(X(e,"(",")"),[","]).map(e=>t(e.trim())))}};var he=ce,ue=function(e){return e.filter((e,t,r)=>r.indexOf(e)===t)};const me=class extends j{};Object.defineProperty(me.prototype,"jsenType",{get:()=>"AssertionExpression"});var de=me;const fe=class extends de{constructor(e,t){super(),this.exprs=e,this.logic=t}eval(e=null,t=null){if("!"===this.logic)return!F(this.exprs).eval(e,t);H(fe.operators);for(var r=(this.logic||"").trim().toUpperCase(),s=r===(fe.operators.or||"").trim().toUpperCase(),n=r===(fe.operators.nor||"").trim().toUpperCase(),i=r===(fe.operators.and||"").trim().toUpperCase(),a=r===(fe.operators.nand||"").trim().toUpperCase(),o=!0,l=0,p=0;p<this.exprs.length;p++){if(i&&!o)return!1;if(a&&!o)return!0;if(o=this.exprs[p].eval(e,t),s&&o)return o;l+=o?1:0}return s?o:i||a?i:n&&0===l}toString(e=null){return"!"===this.logic?"!"+F(this.exprs).toString(e):this.exprs.map(t=>t.toString(e)).join(" "+this.logic+" ")}static parse(e,t,r=fe){if(e.startsWith("!"))return new r([t(e.substr(1))],"!");var s=U.lex(e,H(r.operators));if(s.tokens.length>1){var n=ue(s.matches);if(n.length>1)throw new Error('"AND" and "OR" logic cannot be asserted in the same expression: '+e+"!");return new r(s.tokens.map(e=>t(e.trim())),F(n))}}};fe.operators={and:"&&",or:"||"};var ge=fe;const ve=class extends k{constructor(e,t,r="="){super(),this.reference=e,this.val=t,this.operator=r}eval(e=null,t=null){var r=this.reference.getEval(e,t),s=this.val.eval(e,t);return!a(r.context)&&!a(r.name)&&(y(t)?t(this,r.context,r.name,s):((r.context instanceof V?W(r.context):r.context)[r.name]=s,!0))}toString(e=null){return[this.reference.toString(e),this.operator,this.val.toString(e)].join(" ")}static parse(e,t,r=ve){var s=U.lex(e,r.operators);if(2===s.tokens.length){var n,i;if(!((n=t(s.tokens.shift().trim()))instanceof A&&(i=t(s.tokens.shift().trim()))))throw new Error("Invalid assignment directive: "+e);return new r(n,i,s.matches[0].trim())}}};ve.operators=[" = "];var be=ve;const ye=class extends j{};Object.defineProperty(ye.prototype,"jsenType",{get:()=>"BooleanType"});var we=ye;const xe=class extends we{constructor(e){super(),this.state=e}eval(){return"true"===this.state.toLowerCase().trim()}toString(){return this.state}static parse(e,t,r=xe){if("true"===(e=e.toLowerCase().trim())||"false"===e)return new r(e)}};var $e=xe;const Ce=class extends N{constructor(e,t){super(),this.reference=e,this.args=t}eval(e=null,t=null){var r=this.reference.getEval(e,t),s=this.args.eval(e,t);if(!a(r.name)){if(y(t))return t(this,r.context,r.name,s);var o=V.create(r.context).slice(),l=o.get(r.name,!0);if(y(l))return l(...s);for(var c=o.slice();c.length&&!h;){var h,u=c.shift(),m=Ce.utils||{};if((h=x(u)&&m.Num?m.Num:i(u)&&m.Str?m.Str:n(u)&&m.Arr?m.Arr:p(u)&&m.Obj?m.Obj:null)&&y(h[r.name]))return s.unshift(u),h[r.name](...s);throw new Error('"'+this+'" is not a function. (Called on '+o.map(e=>typeof e).join(", ")+")")}}}toString(e=null){return this.reference.toString(e)+this.args.toString(e)}static parse(e,t,r=Ce){if(!e.startsWith("(")&&e.endsWith(")")&&!U.match(e,[" "]).length){var s,n=U.split(e,[]),i=n.pop();if(!((s=t(n.join("")))instanceof A&&(i=t(i,[he]))))throw new Error("Invalid call directive: "+e);return new r(s,i)}}};var Ee=Ce;const je=class extends j{};Object.defineProperty(je.prototype,"jsenType",{get:()=>"Comments"});var Oe=je;const ke=class extends Oe{constructor(e,t){super(),this.comments=e,this.type=t}eval(e=null,t=null){}toString(e=null){return""}static parse(e,t,r=ke){var s=null,n=null,i=0,a="before";if(e.startsWith("//"))s=(o=U.split(Z(e,"//"),["\r\n"])).shift().trim(),n=o.shift().trim(),i=1;else if(e.startsWith("/*")){s=(o=U.split(Z(e,"/*"),["*/"])).shift().trim(),n=o.shift().trim(),i=2}else if(e.endsWith("*/")){var o;s=(o=U.split(_beforeLast(e,"*/"),["/*"])).pop().trim(),n=o.pop().trim(),i=2;a="after"}if(i&&(2===i&&(s=U.split(s.trim(),["\r\n"]).map(e=>e.replace(/^[\*]+/,"")).filter(e=>e.trim())),console.log(s,a,e),s=new r(s,i)),n)return(n=t(n)).meta.commenta=s,n}};var Se=ke,Ae=function(e,t,r=null){return n(t)?e.filter(e=>r?t.filter(t=>r(e,t)).length:-1===t.indexOf(e)):[]};const _e=class extends j{};Object.defineProperty(_e.prototype,"jsenType",{get:()=>"ComparisonExpression"});var Pe=_e;const Re=class extends Pe{constructor(e,t,r){super(),this.operand1=e,this.operand2=t,this.operator=r}eval(e=null,t=null){return Re.compare(this.operand1.eval(e,t),this.operand2.eval(e,t),this.operator)}toString(e=null){return[this.operand1.toString(e),this.operator,this.operand2.toString(e)].join(" ")}static parse(e,t,r=Re){var s=H(r.operators).map(e=>" "+e+" "),n=U.lex(e,s);if(n.tokens.length>1){if(n.tokens.length>2)throw new Error('Malformed "Comparison" expression: '+e+"!");return new r(t(F(n.tokens).trim()),t(W(n.tokens).trim()),n.matches[0].trim())}}static compare(e,t,r="=="){if(-1===H(Re.operators).indexOf(r))throw new Error('The operator "'+r+'" is not recognized.');if(n(e)&&n(t)&&"==="!==r){if(e.length!==t.length)return!1;var s=!0;e.sort(),t.sort();for(var a=0;a<e.length;a++)s=s&&Re.compare(e[a],t[a],r);return s}if(p(e)&&p(t)&&"==="!==r){var o=Object.keys(e),l=Object.keys(t);if(o.length!==l.length||Ae(o,l).length)return!1;var c=!0;return $(o,(s,n)=>{c=c&&Re.compare(e[n],t[n],r)}),c}switch(r){case"===":return e===t;case"==":case"=":return e==t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t;case"!=":return e!=t;case"!==":return e!==t;case"^=":return i(e)&&e.startsWith(t);case"$=":return i(e)&&e.endsWith(t);case"*=":return!(!n(t)&&!i(t))&&e.indexOf(t)>-1;case"~=":return i(e)&&i(t)&&(" "+e+" ").indexOf(" "+t+" ")>-1;case">=<":if(!n(t)||2!==t.length)throw new Error("A 'Between' comparison requires argument 2 to be an array of exactly 2 values.");return e>=t[0]&&e<=t[1];case"/**/":return t.match(new RegExp(e));default:return!1}}static diff(e,t,r){return!Re.compare(e,t,r?"===":"==")}};Re.operators={exact:{is:"===",isNull:"===",equalsTo:"==",notEqualsTo:"!="},relative:{lesserThan:"<",greaterThan:">",lesserThanOrEqualsTo:"<=",greaterThanOrEqualsTo:">=",between:">=<"},partial:{startsWith:"^=",endsWith:"$=",contains:"*=",any:"~=",in:"~=",matches:"/**/"}};var Ne=Re;const Me=class extends j{};Object.defineProperty(Me.prototype,"jsenType",{get:()=>"ConditionExpression"});var Te=Me;const Le=class extends Te{constructor(e,t,r){super(),this.assertion=e,this.onTrue=t,this.onFalse=r}eval(e=null,t=null){return this.assertion.eval(e,t)?this.onTrue.eval(e,t):this.onFalse.eval(e,t)}toString(e=null){return[this.assertion.toString(e),Le.operators[0],this.onTrue.toString(e),Le.operators[1],this.onFalse.toString(e)].join(" ")}static parse(e,t,r=Le){var s=U.split(e,r.operators);if(s.length>1){if(2===s.length)throw new Error("Malformed ternary expression: "+e+"!");return new r(t(s[0].trim()),t(s[1].trim()),t(s[2].trim()))}}};Le.operators=["?",":"];var He=Le;const Fe=class extends P{constructor(e,t="delete"){super(),this.reference=e,this.operator=t}eval(e=null,t=null){var r=this.reference.getEval(e,t);return!a(r.context)&&!a(r.name)&&(y(t)?t(this,r.context,r.name):(delete(r.context instanceof V?W(r.context):r.context)[r.name],!0))}toString(e=null){return this.operator+" "+this.reference.toString(e)}static parse(e,t,r=Fe){var s=U.lex(e,Object.values(r.operators));if(1===s.matches.length&&e.startsWith(s.matches[0]+" ")){var n;if(!((n=t(s.tokens.pop().trim()))instanceof A))throw new Error("Invalid delete directive: "+e);return new r(n,s.matches[0].trim())}}};Fe.operators={red:"reduce",del:"delete"};var We=Fe,De=function(e,t=[]){var r=0;return x(arguments[0])&&l(arguments[1])&&(r=arguments[0],e=arguments[1],t=arguments[2]||[]),q([r,{},e],(e,r,s)=>y(t)?t(e):!n(t)||!t.length||t.indexOf(e)>-1,!1,!1,!1)};const qe=class extends j{};Object.defineProperty(qe.prototype,"jsenType",{get:()=>"FunctionType"});var Be=qe;const Ie=class extends Be{constructor(e,t,r={}){super(),this.paramters=e||{},this.statements=t,this.arrowFunctionFormatting=r}inherit(e){if(e instanceof Be){for(var t=Object.keys(e.paramters),r=Object.keys(this.paramters),s=0;s<Math.max(r.length,t.length);s++){var n=t[s],i=r[s];if(!i&&n)throw new Error("Parameter #"+s+" ("+n+") in parent function must be implemented.");if(i&&n){var a=e.paramters[n],o=this.paramters[i];if(o&&!a)throw new Error("Parameter #"+s+" ("+i+") must not have a default value as established in parent function.");if(o&&a&&o.jsenType!==a.jsenType)throw new Error("Default value for parameter #"+s+" ("+i+") must be of type "+a.jsenType+" as established in parent function.")}}this.sup=e}return this}eval(e=null,t=null){return(...r)=>{var s={};$(Object.keys(this.paramters),(n,i)=>{var a=this.paramters[i];if(r.length-1<n&&!a)throw new Error('The parameter "'+i+'" is required.');s[i]=r.length>n?r[n]:this.paramters[i]?this.paramters[i].eval(e,t):null});var n=V.create(s).concat(V.create(e));return this.statements.eval(n,t)}}toString(e=null){var t=[];if($(this.paramters,(r,s)=>{t.push(r+(s?"="+s.toString(e):""))}),this.arrowFunctionFormatting){var r=!1===this.arrowFunctionFormatting.head||1===t.length&&-1===t[0].indexOf("="),s=!1===this.arrowFunctionFormatting.body;return(r?t[0]:"("+t.join(", ")+")")+" => "+(s?this.statements.toString(e):"{"+this.statements.toString(e)+"}")}return"function ("+t.join(", ")+") {"+this.statements.toString(e)+"}"}static parse(e,t,r=Ie){var s;if((e=e.trim()).startsWith("function")&&(s=U.split(e,[]).slice(1).filter(e=>e.trim()))&&2===s.length)var n=!1,i=X(s.shift().trim(),"(",")"),a=X(s.shift().trim(),"{","}");else{if(e.startsWith("function")||!(s=U.split(e,["=>"]))||2!==s.length)return;i=s.shift().trim(),a=s.shift().trim(),n={};Y(i,"(",")")?i=X(i,"(",")"):n.head=!1,Y(a,"{","}")?a=X(a,"{","}"):n.body=!1}var o={};U.split(i,[","]).forEach(e=>{var r=e.split("=");r[1]?o[r[0].trim()]=t(r[1].trim()):o[e.trim()]=null});var l=t(a);return new r(o,l,n)}};Ie.operators=["=>"];var Qe=Ie;const Ue=class extends j{};Object.defineProperty(Ue.prototype,"jsenType",{get:()=>"MathExpression"});var Ke=Ue;const ze=class extends Ke{constructor(e,t){super(),this.val=e,this.exprs=t}eval(e=null,t=null){return this.exprs.reduce((r,s)=>{var n=s.val.eval(e,t),i=s.operator.trim();if(!(x(r)&&x(n)||"+"===i))throw new Error("Invalid Math expression: "+this.toString()+"!");switch(i){case"+":return r+n;case"-":return r-n;case"*":return r*n;case"/":return r/n}},this.val.eval(e,t))}toString(e=null){return[this.val.toString(e)].concat(this.exprs.map(t=>t.operator+" "+t.val.toString(e))).join(" ")}static parse(e,t,r=ze){var s=U.lex(e,H(r.operators));if(s.tokens.length>1&&s.matches.length===s.tokens.length-1){var n=ue(s.matches);if(u(n,ze.operators.sup).length&&u(n,ze.operators.sub).length)throw new Error('"Addition/subtraction" and "multiplication/division" operators cannot be used in the same expression: '+e+"!");return new r(t(s.tokens.shift().trim()),s.tokens.map((e,r)=>({operator:s.matches[r],val:t(e.trim())})))}}};ze.operators={sup:["*","/"],sub:[" + "," - "]};var Je=ze;const Ve=class extends j{};Object.defineProperty(Ve.prototype,"jsenType",{get:()=>"NumberType"});var Ye=Ve;const Ze=class extends Ye{constructor(e,t=0){super(),this.int=e,this.dec=t}eval(){return parseFloat(this.int+(this.dec?"."+this.dec:null))}toString(e=null){return this.int+(this.dec?"."+this.dec:null)}static parse(e,t,r=Ze){if(x(e)){e=e.split(".");return new r(parseInt(e.shift()),parseInt(e.shift()))}}};var Ge=Ze;const Xe=class extends j{};Object.defineProperty(Xe.prototype,"jsenType",{get:()=>"ObjectType"});var et=Xe;const tt=class extends et{constructor(e){super(),this.entries=e||{}}inherit(e){return e instanceof et&&$(e.entries,(e,t)=>{e in this.entries||(this.entries[e]=t)}),this}eval(e=null,t=null){var r={};return $(this.entries,(s,n)=>{r[s]=n.eval(e,t)}),r}toString(e=null){var t=[];return $(this.entries,(r,s)=>{t.push(r+tt.operators.sub+s.toString(e))}),"{"+t.join(tt.operators.sup)+"}"}static parse(e,t,r=tt){if(Y(e,"{","}")&&!U.match(e.trim(),[" "]).length){var s={},n=U.split(X(e,"{","}"),[tt.operators.sup]).map(e=>e.trim()).filter(e=>e);return $(n,(e,r)=>{var n=U.split(r,[tt.operators.sub],{limit:1});s[F(n).trim()]=t(W(n).trim())}),new r(s)}}};tt.operators={sup:",",sub:":"};var rt=tt;const st=class extends A{constructor(e,t,r=!1){super(),this.context=e,this.name=t,this.backticks=r}getEval(e=null,t=null){var r=e,s=this.name;return this.context&&(s instanceof j&&(s=s.eval(e,t)),r=this.context.eval(e,t)),{context:r,name:s}}eval(e=null,t=null){var r=this.getEval(e,t);if(!a(r.context)&&!a(r.name))return y(t)?t(this,r.context,r.name):V.create(r.context).get(r.name)}toString(e=null){var t=this.name;if(this.context){var r=this.context.toString(e);t instanceof j?t="["+t.toString(e)+"]":this.backticks&&(t="`"+t+"`")}else{r=e;this.backticks&&(t="`"+t+"`")}return(r||"")+(r&&!t.startsWith("[")?st.separator:"")+t}static parse(e,t,r=st){if(!U.match(e.trim(),[" "]).length){var s,n,i=U.split(e,[]),a=i.pop(),o=U.split(a.trim(),[r.separator],{preserveDelims:!0});if(o.length>1&&(a=o.pop().substr(1),i=i.concat(o)),Y(a,"`","`")&&(a=X(a,"`","`"),n=!0),i.length&&((s=t(i.join(""))).isContext=!0),Y(a,"[","]")){if(!s)throw new Error("Invalid reference: "+e+"!");a=t(X(a,"[","]"))}return new r(s,a,n)}}};st.separator=".";var nt=st;const it=class extends j{};Object.defineProperty(it.prototype,"jsenType",{get:()=>"ReturnDirective"});var at=it;const ot=class extends at{constructor(e){super(),this.expr=e}eval(e=null,t=null){return this.expr?this.expr.eval(e,t):void 0}toString(e=null){return this.expr?"return "+this.expr.toString(e):"return"}static parse(e,t,r=ot){var s=e.toLowerCase();if(s.startsWith("return ")||"return"===s)return new r(t(e.substr(6).trim()))}};var lt=ot;const pt=class extends j{};Object.defineProperty(pt.prototype,"jsenType",{get:()=>"Statements"});var ct=pt;const ht=class extends ct{constructor(e,t){super(),this.stmts=exprs,this.delim=t}eval(e=null,t=null){for(var r=[],s=0;s<this.stmts.length;s++){if(this.stmts[s]instanceof at)return this.stmts[s].eval(e,t);r[s]=this.stmts[s].eval(e,t)}return r}toString(e=null){return this.stmts.map(t=>t.toString(e)).join(this.delim)}static parse(e,t,r=ht){var s=U.lex(e,H(r.operators));if(s.tokens.length>1)return new r(s.tokens.map(e=>t(e)),s.matches[0].trim())}};ht.operators=[";","\r\n"];var ut=ht;const mt=class extends j{};Object.defineProperty(mt.prototype,"jsenType",{get:()=>"StringType"});var dt=mt;const ft=class extends dt{constructor(e,t){super(),this.expr=e,this.quote=t}eval(){return this.expr}toString(){return this.quote+this.expr+this.quote}static parse(e,t,r=ft){if(e=e.trim(),(Y(e,'"','"')||Y(e,"'","'"))&&!U.match(e,[" "]).length){var s=Y(e,'"','"')?'"':"'";return new r(X(e,s,s),s)}}};var gt=ft;T.grammars={Comments:Se,Return:lt,Statements:ut,Deletion:We,Assignment:be,Func:Qe,Abstraction:se,Condition:He,Assertion:ge,Comparison:Ne,Math:Je,Arr:oe,Obj:rt,Num:Ge,Str:gt,Bool:$e,Call:Ee,Reference:nt};var vt=T,bt=function(e){return p(e)&&e.__proxyTargetByCommons||!1},yt=function(e){return bt(e)?e.__proxyTargetByCommons:void 0},wt=function(e){return"number"==typeof e},xt=function(...e){return q(e,(e,t,r)=>{if(n(t)&&n(r)){if(-1===t.indexOf(r[e]))return!0}else if(!(e in t))return!0})},$t=function(e,...t){return t.forEach(t=>{t.forEach(r=>h(e,...c(t)))}),e};var Ct=class{constructor(e){this.$={propagationStopped:!1,defaultPrevented:!1,promisesInstance:null,promises:[]},$(e,(e,t)=>{this[e]=t})}stopPropagation(){this.$.propagationStopped=!0}get propagationStopped(){return this.$.propagationStopped}preventDefault(){this.$.defaultPrevented=!0}get defaultPrevented(){return this.$.defaultPrevented}promise(e){if(!(e instanceof Promise))throw new Error("Event.promise() must be called with a Promise.");this.$.promises.push(e),this.$.promisesInstance=null}get promises(){return!this.$.promisesInstance&&this.$.promises.length&&(this.$.promisesInstance=Promise.all(this.$.promises)),this.$.promisesInstance}};var Et=class{constructor(){this.$={listeners:[]}}addListener(e,t,r={},s=null){if(y(e)&&(s=arguments.length>2?r:"",r=t,t=e,e=null),!y(t))throw new Error('Callback must be a function; "'+typeof t+'" given!');var n={eventNames:e,callback:t,params:r,tag:s,remove:()=>{v(this.$.listeners,n)}};return this.$.listeners.push(n),n}removeListener(e,t=null,r={},s=null){y(e)&&(s=arguments.length>2?r:"",r=t||{},t=e,e=null);for(var n=!1,i=0;i<this.$.listeners.length;i++)!o(e)&&!E(c(this.$.listeners[i].eventNames),c(e))||!o(t)&&this.$.listeners[i].callback!==t||!o(r)&&!E(this.$.listeners[i].params,r)||!o(s)&&this.$.listeners[i].tag!==s||(this.$.listeners[i].removeCallback&&this.$.listeners[i].removeCallback(),this.$.listeners[i].remove(),n=!0);return n}eventsAll(){var e=[];return(this.$.listeners||[]).forEach(t=>{o(t.eventNames)||(e=$t(e,c(t.eventNames)))}),e}fire(e,t){var r=t instanceof Ct?t:new Ct(t);e=c(e),this.$.currentlyFiring=this.$.currentlyFiring||[];var s=Ae(e,this.$.currentlyFiring);if(s.length){$t(this.$.currentlyFiring,s);for(var n=0;n<(this.$.listeners||[]).length;n++)if(!r.propagationStopped){var i=this.$.listeners[n],a=i.params||{},o=c(i.eventNames).map(e=>e.replace(/\`/g,""));if((o.length?o.filter(e=>(r.bubbling&&e.indexOf(".")>-1?r.bubbling:!r.bubbling||a.allowBubbling?s:[]).filter(t=>(e+".").startsWith(t+".")).length).length:!r.bubbling||a.allowBubbling)&&this._shouldFire(i,e,r)){var l,p=this._doFire(i,e,r);!1===p||p instanceof Ct&&p.propagationStopped?r.stopPropagation():!1===p||p instanceof Ct&&p.defaultPrevented?r.preventDefault():(p instanceof Promise&&(l=p)||p instanceof Ct&&(l=p.promises))&&r.promise(l)}}return function(e,...t){t.forEach(t=>v(e,t))}(this.$.currentlyFiring,...s),r}}_shouldFire(e,t,r){return!0}_doFire(e,t,r){var s=r.context||{},a=r._context||{};if(!o(e.eventNames)){var l=[],p=[];c(e.eventNames).forEach(e=>{e=i(e)?e.split("."):e,l.push(z(s,e)),p.push(z(a,e))});return n(e.eventNames)?e.callback(l,p,r):e.callback(l[0],p[0],r)}l={},p={};return t.forEach(e=>{var t=i(e)?e.split("."):e;l[e]=z(s,t),p[e]=z(a,t)}),e.callback(l,p,r)}};const jt=class extends Et{constructor(e={},t={}){super(),this.$.params=xt({},t,jt.params),this.$.bubblers={},this.$.state=e,this.$._state=n(e)?e.slice():De(1,e),$(this.$.state,(e,t)=>{this._incoming(e,t)})}observe(...e){return this.addListener(...e)}unobserve(...e){return this.removeListener(...e)}set(e,t){var r={};i(e)||wt(e)?r[e]=t:n(e)?e.forEach(e=>{r[e]=t}):p(e)&&(r=e);var s=Object.keys(r);n(this.$.state)&&(s=s.map(e=>parseInt(e)));var a=[];s.forEach(e=>{e in this.$.state?this._outgoing(e,this.$.state[e]):a.push(e);var t=r[e];if(bt(t)){var s=yt(t);K(s)&&(t=s)}this._incoming(e,t),this.$.state[e]=t});var o=this.fire(s,{context:this.$.state,_context:this.$._state,entries:a,exits:[]});return s.forEach(e=>{this.$._state[e]=this.$.state[e]}),o}del(e){var t=c(e),r=[];t.forEach(e=>{e in this.$.state&&(r.push(e),this._outgoing(e,this.$.state[e])),delete this.$.state[e]});var s=this.fire(t,{context:this.$.state,_context:this.$._state,entries:[],exits:r});return t.forEach(e=>{delete this.$._state[e]}),s}asOwnMethod(e){if(i(e)&&this.$.params.methodPrefix&&e.startsWith(this.$.params.methodPrefix)){var t=e.substr(this.$.params.methodPrefix.length);if(t&&y(t=this[t]))return t.bind(this)}}get(e){var t=this.asOwnMethod(e);if(t)return t;var r=this.$.state[e];return n(this.$.state)&&!x(e)&&y(r)?(...e)=>{var t=this.$.state.slice(),s=r.apply(this.$.state,e),n=ue(Object.keys(t).concat(Object.keys(this.$.state))).filter(e=>{if(e=parseInt(e),this.$.state[e]!==t[e])return e in this.$.state?this._incoming(e,this.$.state[e]):this._outgoing(e,t[e]),!0});return n.length&&(this.fire(n,{context:this.$.state,_context:this.$._state}),this.$._state=this.$.state.slice()),s}:r}has(e){return e in this.$.state}keys(){return Object.keys(this.$.state)}_shouldFire(e,t,r){var s=0,n=0;"CACHE"in r.$||(r.$.CACHE={},r.$._CACHE={});var a=e.params||{};return(o(e.eventNames)?t:c(e.eventNames)).forEach(e=>{if(!(e in r.$.CACHE)){r.$.CACHE[e]={},r.$._CACHE[e]={};var t={},o={},l=i(e)?e.split("."):e;r.$.CACHE[e].val=z(r.context,l,t),r.$._CACHE[e].val=z(r._context,l,o),r.$.CACHE[e].existence=t.exists,r.$._CACHE[e].existence=o.exists,!1===a.diff||"diffing"in r.$.CACHE[e]||(r.$.CACHE[e].diffing=r.bubbling||r.$.CACHE[e].existence!==r.$._CACHE[e].existence||(p(r.$.CACHE[e].val)&&p(r.$._CACHE[e].val)?!E(r.$.CACHE[e].val,r.$._CACHE[e].val):r.$.CACHE[e].val!==r.$._CACHE[e].val))}x(a.pulse)&&r.context&&r._context&&(0===a.pulse&&r.$.CACHE[e].val&&!r.$._CACHE[e].val?n++:1===a.pulse&&!r.$.CACHE[e].val&&r.$._CACHE[e].val&&n++),(!1===a.diff||r.$.CACHE[e].diffing)&&s++}),!n&&s&&super._shouldFire(e,t,r)}_outgoing(e,t){K(t)&&(e in this.$.bubblers&&t.unobserve(this.$.bubblers[e],{allowBubbling:!0}),y(t.getOffsetParent)&&t.getOffsetParent()===this&&t.setOffsetParent(null))}_incoming(e,t){K(t)&&(t.observe(this._getBubbler(e),{allowBubbling:!0}),y(t.getOffsetParent)&&!t.getOffsetParent()&&t.setOffsetParent(this))}setOffsetParent(e){this.$.offsetParent=e}getOffsetParent(){return this.$.offsetParent}_getBubbler(e){return this.$.bubblers=this.$.bubblers||{},this.$.bubblers[e]=(t,r,s)=>{var n={};return n.context=this.$.state,n._context=this.$._state,n.entries=(s.entries||[]).slice(),n.exits=(s.exits||[]).slice(),n.bubbling=(s.bubbling?c(s.bubbling):Object.keys(t)).map(t=>e+"."+t),this.fire(e,n)},this.$.bubblers[e]}warn(e){console.error(e)}error(e){if(this.$.params.strictDebug)throw new Error(e);console.error(e)}proxy(){return function(e,t){var r={get:(e,r)=>"__proxyTargetByCommons"===r?e:"__proxyTrapByCommons"===r?t:t.get?t.get(e,r):e[r]};return new Proxy(e,B({},t,r))}(this,{get:function(e,t){var r=e.get(t);return p(r)&&y(r.proxy)&&(r=r.proxy()),r},set:function(e,t,r){return e.set(t,r),!0},has:function(e,t){return e.has(t)},deleteProperty:function(e,t){return e.del(t)},ownKeys:function(e){return Object.keys(e.$.state)},defineProperty:function(e,t,r){return Object.defineProperty(e.$.state,t,r),e.set(t,e.$.state[t]),!0},getOwnPropertyDescriptor:function(e,t){return Object.getOwnPropertyDescriptor(e.$.state,t)},getOwnPropertySymbols:function(e){return Object.getOwnPropertySymbols(e.$.state)},getOwnPropertyNames:function(e){return Object.getOwnPropertyNames(e.$.state)}})}};jt.params={methodPrefix:"$"};var Ot=jt;const kt=class{constructor(e,t,r=null){this.key=e,this.value=t,this.flag=r}toString(e=null){return this.key+": "+this.value+(this.flag?" "+this.flag:"")}static parse(e,t={}){if(e){var r=De(t);r.limit=1;var s=U.split(e,[":"],r);if(s.length<2)throw new Error("Malformed def: "+e);var n,i,a=s.shift().trim(),o=U.split(s.shift().trim(),[" "],t);return o.length>1&&kt.flags.includes(W(o).trim().toLowerCase())&&(i=o.pop().trim().toLowerCase()),n=o.join(" "),new kt(a,n,i)}}};kt.flags=["!replace","!incase"];var St=kt;const At=class{constructor(e=[]){this.entries=[],e.forEach(e=>this.add(e))}filter(e=!1,t=!1){return this.entries.filter(r=>(!r.isDuplicate||e)&&(!r.overridden||t))}toString(e=null,t=!1,r=!0){return this.filter(t,r).map(t=>t.toString(e)).join("; ")+";"}add(e){if(!e.key||!e.value)throw new Error("Def must contain a valid key and value!");return e instanceof St||(e=new St(e.key,e.value,e.flag)),this.entries.forEach(t=>{if(!t.isDuplicate&&!t.overridden){var r=t.key.toString(),s=t.value.toString(),n=Y(s,"(",")")?X(s,"(",")"):s,i=e.key.toString(),a=e.value.toString(),o=Y(a,"(",")")?X(a,"(",")"):a,l="!incase"===(t.flag||"").toLowerCase(),p="!replace"===(t.flag||"").toLowerCase(),c="!incase"===(e.flag||"").toLowerCase(),h="!replace"===(e.flag||"").toLowerCase();r===i&&(s!==a&&n!==o||p!==h&&l!==c?h||l?t.overridden=!0:(p||c)&&(e.overridden=!0):e.isDuplicate=!0)}}),this.entries.push(e),this}static parse(e,t={}){return new At(U.split(e,[";"],t).filter(e=>e.trim()).map(e=>St.parse(e.trim())))}};var _t=At;const Pt=class{constructor(e={}){this.block={},this.apply(e)}toString(e=null,t=!1,r=!0){var s=[];return $(this.block,(n,i)=>{s.push("@"+n),s.push("{"+i.toString(e,t,r)+"}")}),s.join(" ")}apply(e){var t=e;if(e instanceof Pt)t=e.block;else if(!p(e))throw new Error("Argument #1 must only be an object or an instance of ./DefSheet!");return $(t,(e,t)=>{this.applyTo(e,t)}),this}applyTo(e,t){var r=t;if(t instanceof _t)r=t.entries;else if(!n(t))throw new Error("Argument #1 must only be an array or an instance of ./DefBlock!");return this.block[e]||(this.block[e]=new _t),r.forEach(t=>this.block[e].add(De(t))),this}static parse(e,t={}){for(var r,s,n=U.split(e,[],t),i={};(r=n.shift())&&(s=n.shift());)i[r.trim().toLowerCase().substr(1)]=_t.parse(X(s.trim(),"{","}"),t);return new Pt(i)}};var Rt=Pt;const Nt=class extends Ot{constructor(e,t={}){if(super({},t),this.root=this.el=e,"#document"===e.nodeName)this.el=e.querySelector("html");else if(!(e instanceof HTMLElement))throw new Error("Argument #1 must be instanceof of HTMLElement or the document object!");this.$.ns=Nt.parseNamespace(this.el),this.$.defs=Nt.parseCascadedDefSheet(this.el),this.init()}init(){this.free(!1),this.getCpsBlock("init",!0).forEach(e=>e.eval(this)),this.$.bindingsListeners=[];return this.getCpsBlock("directives",!0).forEach(e=>{this.$.params.observeOnly||e.eval(this);var t,r=this.observe((t=e.meta.vars,ue(t.map(e=>s(s(e.toString(),"["),"(")))),(t,r,s)=>{var n=e.eval(this);if(!1!==n)return n},{diff:this.$.params.diff});this.$.bindingsListeners.push(r)}),this}free(e=!0){return e?super.removeListener():this.$.bindingsListeners&&(this.$.bindingsListeners.forEach(e=>e.remove()),this.$.bindingsListeners.splice()),this}clone(e=!0){if(!y(this.$.params.componentCallback))throw new Error("The params.componentCallback function is required!");var t,r=this.el.cloneNode(!0),s={};Nt.paramsAttrs.map(e=>Nt.attributeMap[e]).forEach(e=>{var t;(t=r.getAttribute(e))&&(s.type=t,r.removeAttribute(e))}),(t=c(r.children).filter(e=>e.matches(Nt.elementMap.defsheet))[0])&&t.remove();var n=this.$.params.componentCallback(r,this.$.params,!1);return(bt(n)?yt(n):n).$defs=Rt.parse(this.$.defs.toString(null,!e,!0)),$(s,(e,t)=>{r.setAttribute(e,t)}),t&&r.prepend(t),n}getCpsBlock(e,t=!1){var r=this.$.defs.block[e]?this.$.defs.block[e].filter():[];if(t){var s=[];return r.forEach(e=>{var t=(!1!==this.$.params.chainableDirectives&&e.value.trim().startsWith("(")?U.split(e.value,["."]):[e.value]).map(e=>vt.parse(e,[he],{assert:!1})||vt.parse(e));if(t.length===t.filter(e=>e).length){var r,n=e.key+(t.length>1||t[0]instanceof pe?t.join("."):"("+t[0].toString()+")");(r=vt.parse(n,null,{explain:this.$.params.explainJsen}))?s.push(r):this.error("Malformed CPS expression: "+e.toString())}else this.error("Malformed argument in the CPS expression: "+e.toString())}),s}return r}getRelatedNode(e){var t,r;if(this.computedRelated||(this.computedRelated={},this.getCpsBlock("related",!1).forEach(e=>{this.computedRelated[e.key]=vt.parse(e.value)})),(t=this.computedRelated[e])&&(r=t.eval(this))){if(y(r)&&(r=r(this.el,e),!(i(r)||r instanceof HTMLElement)))throw new Error('The callback for node "'+e+'" returned an invalid type.');if(i(r)&&(r=Nt.toElement(r)),!(r instanceof HTMLElement))throw new Error('"'+e+'" could not be resolved to a valid node instance.');return r}}getExplicitNode(e){if(this.$.roles&&this.$.roles.length||(this.$.roles=(this.el.getAttribute(Nt.attributeMap.superrole)||"").replace("  "," ").split(" ")).length)return(this.$.params.rolecase?[this.$.params.rolecase]:this.$.roles).reduce((t,r)=>{if(!t){var s,n,i="["+CSS.escape(Nt.attributeMap.superrole)+'~="'+r+'"]',a="["+CSS.escape(Nt.attributeMap.subrole)+'~="'+r+"-"+e+'"]';(n=(this.el.shadowRoot||this.el).querySelector(a))&&(this.el.shadowRoot&&(!n.parentNode.closest||!n.parentNode.closest(i))||!this.el.shadowRoot&&n.parentNode&&(s=n.parentNode.closest(i))&&s.isSameNode(this.el))&&(t=n)}return t},null)}getImplicitNode(e){if(!e.match(/[^a-zA-Z0-9\-]/)){var t=[];Nt.schema.aria[e]?t.push({schema:Nt.schema.aria[e],selector:['[role="'+e+'"]']}):t.push({schema:Nt.schema.std[e]||Nt.schema.aria[e],selector:[e,'[role="'+e+'"]']}),$(Nt.schema.std,(r,s)=>{s.implicitRole===e&&t.push({schema:s,selector:[r]})});var r=null;return t.forEach(e=>{(this.el.shadowRoot||this.el).querySelectorAll(e.selector.join(",")).forEach(t=>{Nt.schema.assertNodeBelongsInScopeAs(this.el,t,e.schema)&&(e.schema&&e.schema.singleton?r=t:r&&!n(r)||(r=r||[]).push(t))})}),r}}createNode(e,t){var r=t;if(this.$.params.drilldown){if(t===this.root||t===this.el)t=this;else if(t){if(!y(this.$.params.componentCallback))throw new Error("The params.componentCallback function is required!");var s=De(this.$.params);s.alias=e,t=n(t)?t.map(e=>this.$.params.componentCallback(e,s,!0)):this.$.params.componentCallback(t,s,!0)}}else y(this.$.params.nodeCallback)&&(t=n(t)?t.map(e=>this.$.params.nodeCallback(e)):this.$.params.nodeCallback(t));return this.set(e,t),r&&r!==this.root&&r!==this.el&&!n(r)&&Nt.disconnectedCallback(r,()=>{this.del(e)}),t}get(e){var t,r=this.asOwnMethod(e);return r||("_"===e?this.getOffsetParent():"root"===e&&(t=this.root)||"el"===e&&(t=this.el)?y(this.$.params.nodeCallback)?this.$.params.nodeCallback(t):t:(e in this.$.state||((t=this.getRelatedNode(e))||!this.$.params.implicitOnly&&(t=this.getExplicitNode(e))||!this.$.params.explicitOnly&&(t=this.getImplicitNode(e)))&&this.createNode(e,t),this.$.state[e]))}static parseNamespace(e){var t={roadmap:e.getAttribute(Nt.attributeMap.ns)};return t.roadmap&&(t.namespace=s(t.roadmap,"//"),t.subnamespace=Z(t.roadmap,"//"),t.subnamespace.startsWith("/")&&(t.subnamespace=Z(t.subnamespace,"/")),t.subnamespace.endsWith("//")&&-1===t.subnamespace.indexOf("///")&&(t.subnamespace=t.subnamespace+t.namespace+"//")),t}static parseCascadedDefSheet(e){var t,r,s,n;return(t=c(e.children).filter(e=>e.matches(Nt.elementMap.defsheet))[0])&&(r=Rt.parse((t.textContent||"").trim()))||(r=new Rt),Nt.paramsAttrs.forEach(t=>{(s=e.getAttribute(Nt.attributeMap[t]))&&(n=_t.parse(s))&&r.applyTo(t,n)}),r}static recompose(e,t){if(e.matches(Nt.elementMap.import)){t=t.cloneNode(!0);var r=e.getAttribute(Nt.attributeMap.ns),s=t.getAttribute(Nt.attributeMap.ns),n=(t.getAttribute(Nt.attributeMap.superrole)||"").split(" ").map(e=>e.trim());return t.setAttribute(Nt.attributeMap.ns,r),Nt.recomposeDefs(t,e,"append"),c((e.shadowRoot||e).children).forEach((e,i)=>{if(!e.matches(Nt.elementMap.defsheet)){e=e.cloneNode(!0);var a=[],o=[];if((e.getAttribute(Nt.attributeMap.subrole)||"").split(" ").map(e=>e.trim()).forEach(e=>{var t=n.filter(t=>e.startsWith(t+"-"));t.length&&(a.push(t[0]),o.push(e))}),a.length){var l,p=a.map(e=>"["+CSS.escape(Nt.attributeMap.superrole)+'~="'+e+'"]'),c=o.map(e=>"["+CSS.escape(Nt.attributeMap.subrole)+'~="'+e+'"]');if(!(t.shadowRoot&&(l=t.shadowRoot.querySelectorAll(c))||1===(l=t.querySelectorAll(c)).length&&l[0].closest(p)===t))throw new Error("Composition Error: Node #"+i+" (at "+r+") must match exactly one targetNode in "+s+"! ("+l.length+" matched)");Nt.recomposeDefs(e,l[0],"prepend"),l[0].replaceWith(e)}else t.append(e)}}),t}return Nt.recomposeDefs(e,t,"prepend"),e}static recomposeDefs(e,t,r,s=[]){if(s=s.concat([Nt.attributeMap.ns,...Nt.attributeMap.nocompose]),e.hasAttribute("norecompose")&&(s=s.concat((e.getAttribute("norecompose")||"*").split(" ").map(e=>e.trim()))),y(Nt.recomposeCallback)){var a=Nt.recomposeCallback(e,t,r,s);if(!1===a)return!1;(i(a)||n(a))&&(s=s.concat(a))}ue([Nt.attributeMap.superrole,Nt.attributeMap.subrole,"role","class"]).forEach(n=>{var i,a;if(!s.includes(n)&&!s.includes("*")&&(i=t.getAttribute(n))){if(a=e.getAttribute(n))var o="prepend"===r?[i,a]:[a,i];else o=[i];e.setAttribute(n,ue(o.join(" ").split(" ").map(e=>e.trim())).join(" ")),s.push(n)}}),Nt.paramsAttrs.map(e=>Nt.attributeMap[e]).concat("style").forEach(n=>{var i,a;if(!s.includes(n)&&!s.includes("*")&&(i=t.getAttribute(n))){if(a=e.getAttribute(n))(o="prepend"===r?[i,a]:[a,i])[0].trim().endsWith(";")||(o[0]=o[0]+";");else var o=[i];e.setAttribute(n,o.join(" ")),s.push(n)}});for(var o=0;o<t.attributes.length;o++){var l=t.attributes[o];s.includes(l.name)||s.includes("*")||e.hasAttribute(l.name)||(e.setAttribute(l.name,l.value),s.push(l.name))}if(!s.includes("@cps")&&!s.includes("*")){var p=c((e.shadowRoot||e).children).filter(e=>e.matches(Nt.elementMap.defsheet)),h=c((t.shadowRoot||t).children).filter(e=>e.matches(Nt.elementMap.defsheet));h.length&&(p.length?p[0][r](h[0].textContent):e.prepend(h[0].cloneNode(!0)))}return!0}static toElement(e){if(Nt.ctxt.document){var t;if(e.trim().startsWith("<")){var r=Nt.ctxt.document.createElement("div");r.innerHtml=e,t=r.firstChild}else t=Nt.ctxt.document.querySelector(e);return t}}static disconnectedCallback(e,t){if(e.parentNode){var r=!1;new MutationObserver(s=>{s.forEach(s=>{!r&&c(s.removedNodes).includes(e)&&(r=!0,t())})}).observe(e.parentNode,{childList:!0}),Nt.disconnectedCallback(e.parentNode,()=>{r||(r=!0,t())})}}};Nt.ctxt={},Nt.schema=d,Nt.elementMap={defsheet:'script[type="text/jsen-p"]',bundle:"chtml-bundle",import:"chtml-import"},Nt.attributeMap={related:"chtml-related",directives:"chtml-directives",ns:"chtml-ns",superrole:"chtml-role",subrole:"chtml-role",nocompose:["nocompose","shadow"]},Nt.paramsAttrs=["related","directives"];var Mt=Nt;const Tt=class extends Mt{constructor(e,t={}){super(e,xt({},t,Tt.params)),this.observe(this.$.params.dataKey,(e,t)=>{!this.$.ns.subnamespace||i(e)||wt(e)||a(e)||(this.populate(e,this.$.ns.subnamespace,this.$.params.itemCallback),K(e)&&e.observe(t=>{this.populate(e,this.$.ns.subnamespace,this.$.params.itemCallback,Object.keys(t))}))})}bind(e){return this.set(this.$.params.dataKey,e),this}populate(e,t,r=null,s=[]){K(e)&&!bt(e)&&(e=e.proxy()),(arguments.length>3?s:Object.keys(e)).forEach(s=>{s=x(s)?parseInt(s):s;var n=this.has(s)?this.get(s):null;if(a(e[s])){if(n)if(y(r)){var i=r(n,!1,s);"Promise"in Mt.ctxt&&i instanceof Mt.ctxt.Promise?i.then(()=>{n.el.remove()}).catch(()=>{n.el.remove()}):n.el.remove()}else n.free(),n.el.remove()}else{var o=!1;if(!n){var l=t.split("//");l[0]+="/"+s;var p=Tt.import(l.join("//"));if(p){var c=function(e,t,r=!1,s=!1,n=!1){if(-1===e.indexOf(t))return r?[]:void 0;var i=!0===r?e.length-1:!1===r?1:r,o=n?e.lastIndexOf(t)+1:e.indexOf(t)+1,l=a(t)?[]:e.slice(o,o+i);return s&&l.length<i&&l.length<e.length&&(l=l.concat(e.slice(0,i-l.length))),r?l:l[0]}(Object.keys(e),s+"",!0).reduce((e,t)=>e||(this.has(t)?this.get(t):null),null);c?c.el.before(p):this.el.append(p),n=this.createNode(s,p),o=!0}}n&&(y(r)?r(n,e[s],s,o):n.bind(e[s]))}})}static from(e,t={},r=!0,n=Tt){var a=e;if(i(e)&&!e.trim().startsWith("<")&&-1!==e.indexOf("/")){if(!Mt.bundles||!(a=Tt.import(s(e,"//"))))throw new Error('No element found on the namespace "'+e+'"!')}else{if(i(e)&&!(a=Mt.toElement(e)))throw new Error('Could not resolve the string "'+e+'" to an element!');if(r&&Mt.bundles){var o,l,p,c=a.matches(Mt.elementMap.import);if((o=s(a.getAttribute(Mt.attributeMap.ns)||"","//"))&&(c&&(l=o)||(l=G(o,"/"))&&l.indexOf("/")>-1)&&(p=Tt.import(l))){var h=a;a=Mt.recompose(a,p),c&&h.replaceWith(a)}else o&&console.warn("Namespace resolution failed: "+o)}}return new n(a,t)}static import(e){return Mt.bundles.find(e)}};Tt.params={diff:!0,dataKey:"$",drilldown:!1,nodeCallback:null,componentCallback:Tt.from,observeOnly:!1};var Lt=Tt;Mt.ctxt=window;var Ht=new Promise(e=>{"complete"!==document.readyState?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):e()});Mt.ready=(e,t=!0)=>{Ht.then(()=>{t?Mt.initObj.loadingBundlesPromise.then(e):e()})},Ht.then(()=>{var e,t,r,s,n;Mt.initObj=(e=c(document.querySelectorAll('template[is="'+Mt.elementMap.bundle+'"]')).reverse(),t=e.filter(e=>e.hasAttribute("src")&&!e.content.children.length),r=t.map(e=>new Promise(t=>{e.addEventListener("bundleloadsuccess",t),e.addEventListener("bundleloaderror",t)})),s=Promise.all(r).then(()=>{r.splice(0)}),{contentLoadedPromise:Ht,loadingBundlesPromise:s,bundles:e,remoteBundles:t,loadingBundles:r});var i=[];Mt.bundles=new g(Mt.initObj.bundles,[],(e,t,r,s)=>{Mt.initObj.loadingBundles.length&&!n&&(n=!0,console.warn("Remote bundles are still loading at this time! You should probabbly wrap bundle-dependent code within Chtml.ready(callback[, true/*waitForBundles*/])."));var a=t.join("/");if(i.includes(a))return Mt.bundles.find(t.slice(0,-1).join("/"));i.push(a);var o=e.content.querySelector("["+CSS.escape(Mt.attributeMap.ns)+'="'+a+'"]');if(o&&r){try{var l=[];e.hasAttribute("norecompose")&&(l=(e.getAttribute("norecompose")||"*").split(" ").map(e=>e.trim())),o=Mt.recompose(o,r,"prepend",l)}catch(e){console.error("[Inheritance error at source #"+s+"]: "+e.message)}return i.pop(),o}return i.pop(),o?o.cloneNode(!0):r?r.cloneNode(!0):null})}),customElements.define(Mt.elementMap.bundle,class extends HTMLTemplateElement{attributeChangedCallback(e,t,r){r&&this.load()}load(){var e=this.getAttribute("src");e&&this.content.children.length?console.warn("A CHTML bundle must define only either a remote content or local content! Bundle ignored."):e&&fetch(e).then(e=>e.ok?e.text():Promise.reject(e.statusText)).then(e=>{this.innerHTML=e,this.dispatchEvent(new Event("bundleloadsuccess"))}).catch(t=>{console.warn("Error fetching the bundle at "+e+". ("+t+")"),this.dispatchEvent(new Event("bundleloaderror"))})}static get observedAttributes(){return["src"]}},{extends:"template"}),customElements.define(Mt.elementMap.import,class extends HTMLElement{shouldResolve(){return!this.hasAttribute("ondemand")&&!this.closest("template")&&!this.closest(Mt.elementMap.import+"[ondemand]")}connectedCallback(){this.processed=!1,this.shouldResolve()&&this.resolve()}attributeChangedCallback(e,t,r){this.shouldResolve()&&this.resolve()}resolve(){Lt.ready(()=>{if(!this.parentNode)return!1;var e,t,r=Mt.attributeMap.ns;if((t=s(this.getAttribute(r)||"","//"))&&t!==this.__namespace)if(this.__namespace=t,e=Lt.import(t)){var n=Mt.recompose(this,e);this.hasAttribute("shadow")?(this.parentNode.shadowRoot||this.parentNode.attachShadow({mode:"open"}),this.parentNode.shadowRoot.append(n),this.remove()):this.replaceWith(n)}else this.innnerText='No element found on the namespace "'+t+'"!'})}static get observedAttributes(){return["ondemand",Mt.attributeMap.ns]}});var Ft=Lt;window.OnePhrase||(window.OnePhrase={}),window.OnePhrase.Chtml=Ft}]);
//# sourceMappingURL=main.js.map