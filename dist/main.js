!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"_wrapped",(function(){return p})),r.d(n,"_unwrap",(function(){return u})),r.d(n,"_before",(function(){return h})),r.d(n,"_beforeLast",(function(){return f})),r.d(n,"_after",(function(){return d})),r.d(n,"_afterLast",(function(){return m})),r.d(n,"_toTitle",(function(){return g})),r.d(n,"_toCamel",(function(){return v})),r.d(n,"_fromCamel",(function(){return b})),r.d(n,"_matches",(function(){return y}));var s={};r.r(s),r.d(s,"_from",(function(){return w})),r.d(s,"_with",(function(){return x})),r.d(s,"_each",(function(){return $})),r.d(s,"_get",(function(){return _})),r.d(s,"_set",(function(){return C})),r.d(s,"_unset",(function(){return O})),r.d(s,"_isset",(function(){return E})),r.d(s,"_first",(function(){return j})),r.d(s,"_last",(function(){return k})),r.d(s,"_sample",(function(){return A})),r.d(s,"_find",(function(){return S})),r.d(s,"_getAllPropertyNames",(function(){return P})),r.d(s,"_getPrototypeChain",(function(){return T})),r.d(s,"_copyPlain",(function(){return M})),r.d(s,"_copy",(function(){return N})),r.d(s,"_merge",(function(){return R})),r.d(s,"_inherit",(function(){return L})),r.d(s,"_replace",(function(){return D})),r.d(s,"_even",(function(){return H})),r.d(s,"_match",(function(){return q})),r.d(s,"_diff",(function(){return B})),r.d(s,"_percentageMatch",(function(){return F})),r.d(s,"_percentageDiff",(function(){return W})),r.d(s,"_mergeCallback",(function(){return I})),r.d(s,"_compareCallback",(function(){return U}));var o={};r.r(o),r.d(o,"_isString",(function(){return Q})),r.d(o,"_isNumber",(function(){return z})),r.d(o,"_isNumeric",(function(){return G})),r.d(o,"_isArray",(function(){return K})),r.d(o,"_isTypeArray",(function(){return J})),r.d(o,"_isObject",(function(){return Z})),r.d(o,"_isTypeObject",(function(){return V})),r.d(o,"_isFunction",(function(){return Y})),r.d(o,"_isTypeFunction",(function(){return X})),r.d(o,"_isClass",(function(){return ee})),r.d(o,"_isUndefined",(function(){return te})),r.d(o,"_isBoolean",(function(){return re})),r.d(o,"_isNull",(function(){return ne})),r.d(o,"_isEmpty",(function(){return se})),r.d(o,"_getType",(function(){return ie})),r.d(o,"_isObservable",(function(){return oe})),r.d(o,"_isProxy",(function(){return le})),r.d(o,"_getProxyTarget",(function(){return ce})),r.d(o,"_getProxyTrap",(function(){return pe})),r.d(o,"_proxy",(function(){return ae})),r.d(o,"_mixin",(function(){return ue})),r.d(o,"_instanceof",(function(){return he}));var a={};r.r(a),r.d(a,"_from",(function(){return fe})),r.d(a,"_first",(function(){return de})),r.d(a,"_last",(function(){return me})),r.d(a,"_avg",(function(){return ge})),r.d(a,"_max",(function(){return ve})),r.d(a,"_min",(function(){return be})),r.d(a,"_rand",(function(){return ye})),r.d(a,"_sum",(function(){return we})),r.d(a,"_slice",(function(){return xe})),r.d(a,"_preceding",(function(){return $e})),r.d(a,"_following",(function(){return _e})),r.d(a,"_precedingLast",(function(){return Ce})),r.d(a,"_followingLast",(function(){return Oe})),r.d(a,"_between",(function(){return Ee})),r.d(a,"_intersect",(function(){return je})),r.d(a,"_difference",(function(){return ke})),r.d(a,"_filter",(function(){return Ae})),r.d(a,"_divide",(function(){return Se})),r.d(a,"_flatten",(function(){return Pe})),r.d(a,"_sort",(function(){return Te})),r.d(a,"_unique",(function(){return Me})),r.d(a,"_pushUnique",(function(){return Ne})),r.d(a,"_concatUnique",(function(){return Re})),r.d(a,"_remove",(function(){return Le})),r.d(a,"_exclude",(function(){return De})),r.d(a,"_replace",(function(){return He})),r.d(a,"_concatBefore",(function(){return qe})),r.d(a,"_concatAfter",(function(){return Be})),r.d(a,"_concatBeforeLast",(function(){return Fe})),r.d(a,"_concatAfterLast",(function(){return We})),r.d(a,"_all",(function(){return Ie})),r.d(a,"_any",(function(){return Ue})),r.d(a,"_inSequence",(function(){return Qe}));var l={};r.r(l),r.d(l,"_closest",(function(){return Cr})),r.d(l,"_fromWords",(function(){return Or}));var c={};r.r(c),r.d(c,"Arr",(function(){return kr})),r.d(c,"Js",(function(){return Ar})),r.d(c,"Num",(function(){return Sr})),r.d(c,"Obj",(function(){return Pr})),r.d(c,"Str",(function(){return Tr})),r.d(c,"standardize",(function(){return Er}));const p=function(e,t,r){return e.startsWith(t)&&e.endsWith(r)},u=function(e,t,r){return f(d(e,t),r)},h=function(e,t,r=!1){if(""==t)return e;var n=r?e.lastIndexOf(t):e.indexOf(t);return-1===n?e:e.substr(0,n)},f=function(e,t){return h(e,t,!0)},d=function(e,t,r=!1){if(""==t)return e;var n=r?e.lastIndexOf(t):e.indexOf(t);return-1===n?"":e.substr(n+t.length)},m=function(e,t){return d(e,t,!0)},g=function(e,t){return"string"!=typeof e?e:e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+(void 0!==typeof t&&t?e.substr(1).toLowerCase():e.substr(1))}))},v=function(e,t){return e=g(e.replace(/-/g," ")).replace(/ /g,""),t?e:e[0].toLowerCase()+e.substr(1)},b=function(e,t){return void 0===e?"":e.split(/(?=[A-Z])/).join(t||" ")},y=function(e,t){return lllll},w=function(e,t=null){var r={};return 2===arguments.length&&(Q(e)?r[e]=t:K(e)&&K(t)&&e.forEach((e,n)=>r[e]=t[n])),r},x=function(e,t,r=null){return R(e,Z(t)?t:w(t,r))},$=function(e,t){var r=void 0;return V(e)&&Object.keys(e).forEach(n=>{!1!==r&&(r=t(G(n)?parseFloat(n):n,e[n]))}),r},_=function(e,t,r={},n=!0){t=fe(t).slice();for(var s=e;!te(s)&&!ne(s)&&t.length;){var i=t.shift(),o=n&&oe(s);if(!(o?s.has(i):i in s))return void(r.exists=!1);s=o?s.get(i):s[i]}return r.exists=!0,s},C=function(e,t,r,n={}){t=fe(t);for(var s=e,i=0;i<t.length;i++){if(!(i<t.length-1))return s[t[i]]=r,!0;if(!V(s)&&!Y(s))return!1;if(!V(s[t[i]])){if(!n)return!1;s[t[i]]=Y(n)?n(i):n}s=s[t[i]]}},O=function(e,t,r=!1){t=fe(t);var n=!1;do{var s=""===(s=t.pop())?0:s,i=e;t.length&&(i=_(e,t)),(V(i)||Y(i))&&s in i&&(delete i[s],n=!0)}while(n&&r&&t.length&&(V(i)||Y(i))&&!Object.keys(i).length);return n},E=function(e,t){var r={};return _(e,t,r),r.exists},j=function(e){return K(e)?de(e):e[Object.keys(e)[0]]},k=function(e){return K(e)?me(e):e[me(Object.keys(e))]},A=function(e,t=1){return K(e)?ye(e):N(e,ye(Object.keys(e),t))},S=function(e,t,r=!1){var n=null,s=e;K(e)||(n=Object.keys(e),s=Object.values(e));var i=void 0,o=s.reduce((e,n)=>{if(void 0===i){if(t(n,e))return n;if(r&&(V(n)||Y(n))&&void 0!==(i=S(n,t,r)))return n}return e},void 0);if(void 0!==o){var a=n?n[s.indexOf(o)]:s.indexOf(o);return void 0!==i?[a].concat(fe(i)):a}},P=function(e,t){var r=[];return T(e,t).forEach(e=>{Ne(r,...Object.getOwnPropertyNames(e))}),r},T=function(e,t){t=(t=t||Object.prototype)&&!K(t)?[t]:t;var r=[];for(e=e;e&&(!t||t.indexOf(e)<0)&&"default"!==e.name;)r.push(e),e=e?Object.getPrototypeOf(e):null;return r},M=function(e,t=[]){return I([{},e],(e,r,n)=>{if(!Y(n[e]))return Y(t)?t(e):!K(t)||!t.length||t.indexOf(e)>-1},!1,!1,!1)},N=function(e,t=[]){var r=0;return G(arguments[0])&&V(arguments[1])&&(r=arguments[0],e=arguments[1],t=arguments[2]||[]),I([r,{},e],(e,r,n)=>Y(t)?t(e):!K(t)||!t.length||t.indexOf(e)>-1,!1,!1,!1)},R=function(...e){return I(e,(e,t,r)=>!0)},L=function(...e){return I(e,(e,t,r)=>{if(K(t)&&K(r)){if(-1===t.indexOf(r[e]))return!0}else if(!(e in t))return!0})},D=function(...e){var t=0===Object.keys(e[0]).length;return I(e,(e,r,n,s)=>{if(e in r||t&&0===s)return!0},!1,!0)},H=function(e,t,r=!0,n=1){if(K(e)&&K(t)&&e.length!==t.length||Z(e)&&Z(t)&&Object.keys(e).length!==Object.keys(t).length)return!1;var s=U(e,t,(e,t)=>n>0&&(K(e)&&K(t)||Z(e)&&Z(t))?H(e,t,r,n-1):Y(r)?r(e,t):e===t===r,!1,!1,!0);return K(s)?s.length===e.length:Z(s)?Object.keys(s).length===Object.keys(e).length:s},q=function(e,t,r=!0,n=!0){return U(e,t,(e,t)=>K(e)&&K(t)||Z(e)&&Z(t)?q(e,t,r,n):Y(r)?r(e,t):e===t===r,n)},B=function(e,t,r=!0,n=!0){return U(e,t,(e,t)=>K(e)&&K(t)||Z(e)&&Z(t)?B(e,t,r,n):Y(r)?r(e,t):e===t===r,n,!0)},F=function(e,t,r=!0){var n=U(e,t,(e,t)=>K(e)&&K(t)||Z(e)&&Z(t)?F(e,t,r):(Y(r)?r(e,t):e===t===r)?1:0,!1,!1,!0),s=Z(n)?Object.values(n):n;return s.reduce((e,t)=>e+t,0)/s.length},W=function(e,t,r=!1){return 1-F(e,t,r)},I=function(e,t,r=!1,n=!1,s=!1){var i=0,o=e.shift();if((G(o)||!0===o||!1===o)&&(i=o,o=e.shift()),!e.length)throw new Error("_merge() requires two or more array/objects.");return e.forEach((e,a)=>{(V(e)||Y(e))&&(r?P(e):Object.getOwnPropertyNames(e)).forEach(l=>{var c=o[l],p=e[l];(K(c)&&K(p)||Z(c)&&Z(p))&&(!0===i||i>0)?(o[l]=K(c)&&K(p)?[]:{},I([G(i)?i-1:i,o[l],c,p],t,r,n)):t(l,o,e,a)&&(K(o)&&K(e)?n?o[l]=p:o.push(p):s?Object.defineProperty(o,l,Object.getOwnPropertyDescriptor(e,l)):o[l]=e[l])})}),o},U=function(e,t,r=!0,n=!0,s=!1,i=!1){if(K(e)&&K(t)){var o=[],a=!0;return e.forEach(e=>{if(a){var l=!1;$(t,(t,s)=>{(!l||n&&V(e))&&(l=r(e,s),(K(l)&&!l.length||Z(l)&&!Object.keys(l).length)&&(l=!1),V(l)&&n&&(e=l))}),V(l)?o.push(n?l:e):re(l)?s&&!l||!s&&l?o.push(e):i&&(a=!1):o.push(l)}}),o}if(Z(e)&&Z(t)){o={},a=!0;return Object.keys(e).forEach(l=>{if(a){var c=r(e[l],t[l]);(K(c)&&!c.length||Z(c)&&!Object.keys(c).length)&&(c=!1),V(c)?o[l]=n?c:e[l]:re(c)?s&&!c||!s&&c?o[l]=e[l]:i&&(a=!1):o[l]=c}}),o}},Q=function(e){return"string"==typeof e},z=function(e){return"number"==typeof e},G=function(e){return!0!==e&&!1!==e&&null!==e&&""!==e&&!isNaN(1*e)},K=function(e){return Array.isArray(e)},J=function(e){return!Q(e)&&!te(e.length)},Z=function(e){return!Array.isArray(e)&&"object"==typeof e&&e},V=function(e){return Array.isArray(e)||"object"==typeof e},Y=function(e){return X(e)||e&&"[object function]"==={}.toString.call(e)},X=function(e){return"function"==typeof e},ee=function(e){return X(e)&&/^class\s/.test(Function.prototype.toString.call(e))},te=function(e){return arguments.length&&(void 0===e||void 0===e)},re=function(e){return!0===e||!1===e},ne=function(e){return null===e||""===e},se=function(e){return ne(e)||te(e)||!1===e||0===e||V(e)&&!Object.keys(e).length},ie=function(e){return typeof e},oe=function(e){return Z(e)&&Ie(["observe","unobserve","setOffsetParent","getOffsetParent"],t=>Y(e[t]))},ae=function(e,t){var r={get:(e,r)=>"__proxyTargetByCommons"===r?e:"__proxyTrapByCommons"===r?t:t.get?t.get(e,r):e[r]};return new Proxy(e,R({},t,r))},le=function(e){return Z(e)&&e.__proxyTargetByCommons||!1},ce=function(e){return le(e)?e.__proxyTargetByCommons:void 0},pe=function(e){return le(e)?e.__proxyTrapByCommons:void 0},ue=function(...e){var t={};K(arguments[0])&&(e=arguments[0],t=arguments[1],arguments[2]&&arguments[2]);var r=me(e),n={},s=class extends r{constructor(...e){super(...e)}};return s.prototypes=e,e.forEach(e=>{I([s,e],(e,t,r)=>-1===["name","prototype","prototypes","length"].indexOf(e)),I([s.prototype,e.prototype],(e,t,r)=>-1===["prototype","prototypes"].indexOf(e)&&(!Y(r[e])||(K(n[e])?n[e].push(r[e]):n[e]=[r[e]],!1)),!0)}),$(n,(e,r)=>{"constructor"!==e&&(s.prototype[e]=function(...n){if(Object.hasOwnProperty(t,e)&&Y(t[e]))return t[e].call(this,r,...n);var s=[];return r.forEach(e=>{s.push(e.call(this,...n))}),me(s)})}),s},he=function(e,t){if(!e)return!1;if(e instanceof t)return!0;var r=e=>{for(;e&&e!==Function.prototype;){if(e===t||e.prototypes&&e.prototypes.reduce((e,n)=>e||n===t||r(n),!1))return!0;e=Object.getPrototypeOf(e)}return!1};return r(e.constructor)},fe=function(e){return K(e)?e:!1!==e&&0!==e&&se(e)?[]:J(e)?Array.prototype.slice.call(e):Z(e)?Object.values(e):[e]},de=function(e,t=1){var r=0;e.forEach(e=>{r++});var n=e.slice(e.length-r,t);return arguments.length>1?n:n[0]},me=function(e,t=1){return arguments.length>1?de(e.slice().reverse(),t).reverse():de(e.slice().reverse())},ge=function(e){return e.length?we(e)/e.length:0},ve=function(e){return(e=e.slice()).reduce((e,t)=>Math.max(e,t),e.shift())},be=function(e){return(e=e.slice()).reduce((e,t)=>Math.min(e,t),e.shift())},ye=function(e,t=1){for(var r=[],n=null;r.length<t&&(n=e[Math.floor(Math.random()*e.length)])&&-1===r.indexOf(n);)r.push(n);return arguments.length>1?r:r[0]},we=function(e){return(e=e.slice()).reduce((e,t)=>e+t,e.shift())},xe=function(e,t=0,r=null){return arguments.length>1&&(t=t<0?e.length+t:t,arguments.length>2&&(r=r<0?e.length+r-t:r)),e.slice(t,r)},$e=function(e,t,r=!1,n=!1,s=!1){if(-1===e.indexOf(t))return r?[]:void 0;var i=!0===r?e.length-1:!1===r?1:r,o=(e=e.slice().reverse(),s?e.lastIndexOf(t)+1:e.indexOf(t)+1),a=te(t)?[]:e.slice(o,o+i);return n&&a.length<i&&a.length<e.length&&(a=a.concat(e.slice(0,i-a.length))),r?a:a[0]},_e=function(e,t,r=!1,n=!1,s=!1){if(-1===e.indexOf(t))return r?[]:void 0;var i=!0===r?e.length-1:!1===r?1:r,o=s?e.lastIndexOf(t)+1:e.indexOf(t)+1,a=te(t)?[]:e.slice(o,o+i);return n&&a.length<i&&a.length<e.length&&(a=a.concat(e.slice(0,i-a.length))),r?a:a[0]},Ce=function(e,t,r=!1,n=!1){return $e(e,t,r,n,!0)},Oe=function(e,t,r=!1,n=!1){return _e(e,t,r,n,!0)},Ee=function(e,t,r,n=!1,s=!1,i=!1){var o=i?e.lastIndexOf(t):e.indexOf(t),a=i?e.lastIndexOf(r):e.indexOf(r);if(n){var l=a>o?o+e.length-a:o-a;return $e(e,t,l,s,i)}l=a<o?e.length-o-1+a+1:a-o;return _e(e,t,l,s,i)},je=function(e,t,r=null){return K(t)?e.filter(e=>r?t.filter(t=>r(e,t)).length:-1!==t.indexOf(e)):[]},ke=function(e,t,r=null){return K(t)?e.filter(e=>r?t.filter(t=>r(e,t)).length:-1===t.indexOf(e)):[]},Ae=function(e,t){return Se(e,t)[0]},Se=function(e,t){var r=[],n=[],s=e.length;for(i=0;i<s;i++)t(e[i])?r.push(e[i]):n.push(e[i]);return[r,n]},Pe=function(e,t=1,r=!0){return!G(t)||t<=0?e:(!K(e)&&Z(e)&&r&&(e=Object.values(e)),K(e)?e.reduce((e,n)=>K(n)||Z(n)&&r?e.concat(Pe(K(n)?n:Object.values(n),t-1,r)):e.concat(n),[]):e)},Te=function(e,t,r=null){for(var n=[],s=e.length,i=0;i<s;i++)n.push({index:i,value:r?r(e[i]):e[i]});return n.sort((function(e,t){return Q(e.value)&&"".localeCompare?e.value.localeCompare(t.value):e.value===t.value?0:e.value>t.value?1:-1})),"desc"===(t||"").trim().toLowerCase()&&(n=n.reverse()),n.map(t=>e[t.index])},Me=function(e){return e.filter((e,t,r)=>r.indexOf(e)===t)},Ne=function(e,...t){return t.forEach(t=>{e.indexOf(t)<0&&e.push(t)}),e},Re=function(e,...t){return t.forEach(t=>{t.forEach(r=>Ne(e,...fe(t)))}),e},Le=function(e,t,r=!1){for(var n=e.indexOf(t);n>-1&&(r||!1===r);)e.splice(n,1),r>0&&r--,n=e.indexOf(t);return e},De=function(e,...t){return t.forEach(t=>Le(e,t)),e},He=function(e,t,r=[]){return 2===arguments.length?(t.forEach((t,r)=>{e[r]=t}),e):($(t,(t,n)=>{var s=e.indexOf(n);-1!==s&&(e[s]=r[t])}),e)},qe=function(e,t,r,n=!1){var s=e.splice(n?e.lastIndexOf(t):e.indexOf(t));return r.concat(s).forEach((function(t){e.push(t)})),e},Be=function(e,t,r,n=!1){var s=e.splice(n?e.lastIndexOf(t)+1:e.indexOf(t)+1);return r.concat(s).forEach((function(t){e.push(t)})),e},Fe=function(e,t,r){return qe(e,t,r,!0)},We=function(e,t,r){return Be(e,r,t,!0)},Ie=function(e,t){return e.reduce((e,r)=>e&&t(r),!0)},Ue=function(e,t){return e.reduce((e,r)=>e||t(r),!1)},Qe=function(e,t,r){if(K(e)){if(Z(r))var n=r.sync||!1,s=r.delay||0,i=r.delayAlways||!1;else n=!(!re(r)&&"last"!==r)&&r,s=z(r)?r:0,i=!1;var o=e;return new Promise((function(e,r){if(o.length){var a=function(r){var l=()=>{i?s?setTimeout(()=>{o.length>r+1?a(r+1):e()},s):o.length>r+1?a(r+1):e():o.length>r+1?s?setTimeout(()=>{a(r+1)},s):a(r+1):e()},c=t(o[r]);c instanceof Promise&&(!0===n||"last"===n&&r===o.length-1)?(c.then(l),c.catch(l)):l()};a(0)}else e()}))}},ze={std:{html:{type:["#sectioning-root"],model:["head","body"],singleton:!0},caption:{model:["#flow","!table"],singleton:!0},col:{model:["#nothing"]},colgroup:{model:[{"colgroup[span]":["#nothing"]},{":not(colgroup[span])":["col","template"]}],singleton:!0},dd:{model:["#flow"],implicitRole:"definition"},dt:{model:["#flow","!#heading","!#sectioning","!header","!footer"],implicitRole:"term"},figcaption:{model:["#flow"],singleton:!0},head:{model:["#metadata"],singleton:!0},legend:{model:["#phrasing"],singleton:!0},li:{model:["#flow"],implicitRole:"listitem"},optgroup:{model:["option","#script-supporting"],implicitRole:"group"},option:{model:[{"option[label][value]":["#nothing"]},{"option[label]:not(option[value])":["#text"]},{":not(option[label])":["#text"]}]},param:{model:["#nothing"]},rp:{model:["#text"]},rt:{model:["#phrasing"]},source:{model:["#nothing"]},summary:{model:["#phrasing","#heading"],singleton:!0},track:{model:["#nothing"]},tbody:{model:["#script-supporting","tr"]},td:{model:["#flow","!#heading","!#sectioning","!header","!footer"]},tfoot:{model:["tr","#script-supporting"],singleton:!0},thead:{model:["tr","#script-supporting"],singleton:!0},tr:{model:["#script-supporting","td","th"]},a:{type:["#flow","#phrasing",{"a[href]":["#interactive","#palpable"]}],model:["#transparent","!#interactive","!a"]},abbr:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},address:{type:["#flow","#palpable"],model:["#flow","!#heading","!#sectioning","!header","!footer","!address"]},area:{type:["#flow","#phrasing"],model:["#nothing"]},article:{type:["#flow","#palpable","#sectioning-content"],model:["#flow"],implicitRole:"article",acceptableRoles:["application","article","document","main"]},aside:{type:["#flow","#palpable","#sectioning-content"],model:["#flow"],implicitRole:"complementary",acceptableRoles:["complementary","note","search"]},audio:{type:["#embedded","#flow","#phrasing",{"audio[controls]":["#interactive","#palpable"]}],model:["#transparent","!#media","track",{":not(audio[src])":["source"]}]},b:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},base:{type:["#metadata"],model:["#nothing"],singleton:!0},bdi:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},bdo:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},blockquote:{type:["#flow","#palpable","#sectioning-root"],model:["#flow"]},body:{type:["#sectioning-root"],model:["#flow","@banner","@contentinfo","@complementary","@main"],singleton:!0},br:{type:["#flow","#phrasing"],model:["#nothing"]},button:{type:["#flow","#interactive","#palpable","#phrasing"],model:["#phrasing","!#interactive"]},canvas:{type:["#embedded","#flow","#palpable","#phrasing"],model:["#transparent","!#interactive","a","img[usemap]","button",'input[type="button"]','input[type="radio"]','input[type="checkbox"]',"select[multiple]","select[size>=1]","[tabindex]!#interactive"]},cite:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},code:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},data:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},datalist:{type:["#flow","#phrasing"],model:["#phrasing","#script-supporting","option"]},del:{type:["#flow","#phrasing"],model:["#transparent"]},details:{type:["#flow","#interactive","#palpable","#sectioning-root"],model:["#flow","summary"]},dfn:{type:["#flow","#palpable","#phrasing"],model:["#phrasing","!dfn"],implicitRole:"term"},dialog:{type:["#flow","#sectioning-root"],model:["#flow"],implicitRole:"dialog"},div:{type:["#flow","#palpable"],model:[{"dl > div":["dt","dd"]},{":not(dl > div)":["#flow"]}]},dl:{type:["#flow"],model:["#script-supporting","dl","dt","div"]},em:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},embed:{type:["#embedded","#flow","#phrasing","#interactive","#palpable"],model:["#nothing"]},fieldset:{type:["#flow","#sectioning-root","#palpable"],model:["legend","#flow"]},figure:{type:["#flow","#sectioning-root","#palpable"],model:["#flow","figcaption"],implicitRole:"figure"},footer:{type:["#flow","#palpable"],model:["#flow","!header","!footer"],acceptableRoles:["contentinfo"],singleton:!0},form:{type:["#flow","#palpable"],model:["#flow","!form"]},h1:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h2:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h3:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h4:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h5:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},h6:{type:["#flow","#heading","#palpable"],model:["#phrasing"],implicitRole:"heading"},header:{type:["#flow","#palpable"],model:["#flow","!header","!footer"],acceptableRoles:["banner"],singleton:!0},hgroup:{type:["#flow","#heading","#palpable"],model:["h1","h2","h3","h4","h5","h6","#script-supporting"]},hr:{type:["#flow"],model:["#nothing"],implicitRole:"separator"},i:{type:["#flow","#palpable","#phrasing"],model:["#phrasing"]},iframe:{type:["#embedded","#flow","#phrasing","#interactive","#palpable"],model:["#nothing"]},img:{type:["#embedded","#flow","#phrasing",{"img[usemap]":["#interactive","#palpable"]}],model:["#nothing"]},input:{type:["#flow","#phrasing",{'input:not([type!="hidden"])':["#interactive","#palpable"]}],model:["#nothing"]},ins:{type:["#flow","#phrasing","#palpable"],model:["#transparent"]},kbd:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},label:{type:["#flow","#phrasing","#interactive","#palpable"],model:["#phrasing","!label"]},link:{type:["#metadata",{"body link":["#flow","#phrasing"]}],model:["#nothing"]},main:{type:["#flow","#palpable"],model:["#flow"],implicitRole:"main",singleton:!0},map:{type:["#flow","#phrasing","#palpable"],model:["#transparent"]},mark:{type:["#flow","#phrasing","#palpable"],model:["#transparent"]},math:{type:["#embedded","#flow","#phrasing","#palpable"],model:[]},menu:{type:["#flow",{":contains(> li)":["#palpable"]}],model:["#script-supporting","li"],implicitRole:"list"},meta:{type:["#metadata",{"meta[itemprop]":["#flow","#phrasing"]}],model:["#nothing"],names:["application-name","author","description","generator","keywords","referrer","theme-color"]},meter:{type:["#flow","#labelable","#phrasing","#palpable"],model:["#phrasing","!meter"]},nav:{type:["#flow","#sectioning-content","#palpable"],model:["#flow"],implicitRole:"navigation",acceptableRoles:["navigation"]},noscript:{type:["#metadata","#flow","#phrasing"],model:[{"head link":["style","meta","link"]},{":not(head link)":["#transparent","!noscript"]}]},object:{type:["#embedded","#flow","#phrasing",{"object[usemap]":["#interactive","#palpable"]}],model:["#transparent","param"]},ol:{type:["#flow",{":contains(> li)":["#palpable"]}],model:["#script-supporting","li"],implicitRole:"list"},output:{type:["#flow","#labelable","#phrasing","#palpable"],model:["#phrasing","!meter"]},p:{type:["#flow","#palpable"],model:["#phrasing"]},picture:{type:["#embedded","#flow","#phrasing"],model:["source","img","#acript-supporting"]},pre:{type:["#flow","#palpable"],model:["#phrasing"]},progress:{type:["#flow","#labelable","#phrasing","#palpable"],model:["#phrasing","!progress"]},q:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},ruby:{type:["#flow","#phrasing","#palpable"],model:["rp","rt"]},s:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},samp:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},script:{type:["#flow","#metadata","#phrasing","#acript-supporting"],model:[{"script[src]":[]}]},section:{type:["#flow","#sectioning-content","#palpable"],model:["#flow"],implicitRole:"region",acceptableRoles:["alert","alertdialog","application","contentinfo","dialog","document","log","main","marquee","region","search","status"]},select:{type:["#flow","#interactive","#labelable","#phrasing","#palpable"],model:["option","optgroup","#acript-supporting"]},slot:{type:["#flow","#phrasing"],model:["#transparent"]},small:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},span:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},strong:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},style:{type:["#metadata"],model:["#text"]},sub:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},sup:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},svg:{type:["#embedded","#flow","#phrasing","#palpable"],model:[]},table:{type:["#flow","#palpable"],model:["caption","colgroup","thead","tbody","tr","tfoot","#script-supporting"]},td:{type:["#sectioning-root"],model:["#flow"]},template:{type:["#metadata","#flow","#phrasing","#script-supporting"],model:["#nothing"]},textarea:{type:["#flow","#interactive","#labelable","#phrasing","#palpable"],model:["#text"]},time:{type:["#flow","#phrasing","#palpable"],model:[{"time[datetime]":["#phrasing"]},{":not(time[datetime])":["#text"]}]},title:{type:["#metadata"],model:["#text"],singleton:!0},u:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},ul:{type:["#flow",{":contains(> li)":["#palpable"]}],model:["#script-supporting","li"],implicitRole:"list"},var:{type:["#flow","#phrasing","#palpable"],model:["#phrasing"]},video:{type:["#embedded","#flow","#phrasing",{"video[controls]":["#interactive","#palpable"]}],model:["#transparent","!#media","track",{":not(video[src])":["source"]}]},wbr:{type:["#flow","#phrasing"],model:["#nothing"]}},aria:{banner:{type:["@banner"],singleton:!0},contentinfo:{type:["@contentinfo"],singleton:!0},complementary:{type:["@complementary"],singleton:!0},navigation:{type:["@navigation"],singleton:!0},list:{type:["@list"]},listitem:{type:["@listitem"]}},getContentModelFor(e){var t=e.nodeName.toLowerCase();return ze.std[t]?ze.expandRules(e,ze.std[t].model||[]):[]},getCategoriesFor(e,t=!0){var r=e.nodeName.toLowerCase(),n=ze.std[r]||ze.aria[r]||{},s=[];if(t&&!e.nodeName.startsWith("#")&&(e.hasAttribute("role")||n.implicitRole))if(e.hasAttribute("role")){e.getAttribute("role").split(" ");e.getAttribute("role").split(" ").forEach(t=>{n&&n.acceptableRoles&&!n.acceptableRoles.includes(t)||(t=t.trim(),s.push("@"+t),ze.aria[t]&&ze.aria[t].type&&(s=s.concat(ze.expandRules(e,ze.aria[t].type||[]))))})}else n.implicitRole&&Ne(s,"@"+n.implicitRole,r);else s=Ne(ze.expandRules(e,n.type||[]),r);return s},assertNodeBelongsInContentModel(e,t){var r,n=e instanceof HTMLElement?ze.getContentModelFor(e):e,s=t instanceof HTMLElement?ze.getCategoriesFor(t):t;return!je(n,["#nothing","#text"]).length&&(n.forEach(e=>{if(e.startsWith("!")){var t=e.substr(1);s.includes(t)&&(r=!1)}else!1!==r&&s.includes(e)&&(r=!0)}),r&&!0)},assertNodeBelongsInScopeAs(e,t,r=null){for(var n,s=ze.getCategoriesFor(e),i=t;!n&&(i=i.parentNode);)je(s,ze.getCategoriesFor(i)).length&&ze.assertNodeBelongsInContentModel(i,r&&r.type||t)&&(n=i);return n===e},expandRules(e,t){var r=t.reduce((t,r)=>(Z(r)?e.matches(Object.keys(r)[0])&&(t=t.concat(Object.values(r)[0])):t.push(r),t),[]);return r.includes("#sectioning-root")&&r.push("#sectioning-content"),r}};var Ge=ze;const Ke=class{constructor(e,t,r,n=null){this.sources=fe(e),this.namespace=fe(t),this.getter=r,this.carry=n,this.collections={},this.value}enter(e){return e in this.collections||(this.collections[e]=new Ke(this.sources,this.namespace.concat(e),this.getter,this)),this.collections[e]}leave(){return this.carry}get(){if(!this.value){var e=this.namespace.slice(),t=this.carry?this.carry.get():null;this.sources.forEach((r,n)=>{(t=this.getter.call(null,r,e,t,n))&&(this.value=t)})}return this.value}find(e){for(var t,r,n=e.split("/"),s=this;(r=n.shift())&&(s=s.enter(r));)t=s;var i=t.get();if(i)return i.cloneNode(!0)}};var Je=Ke,Ze=class{even(e){return!(!Z(e)||e.jsenType!==this.jsenType)&&H(e,this)}inherit(e){return this}withComments(e){return this.meta||(this.meta={}),this.meta.comments=e,this}withVars(e){return this.meta||(this.meta={}),this.meta.vars=e,this}};const Ve=class extends Ze{};Object.defineProperty(Ve.prototype,"jsenType",{get:()=>"AssignmentExpression"});var Ye=Ve;const Xe=class extends Ze{};Object.defineProperty(Xe.prototype,"jsenType",{get:()=>"Reference"});var et=Xe;const tt=class extends Ze{};Object.defineProperty(tt.prototype,"jsenType",{get:()=>"DeleteExpression"});var rt=tt;const nt=class extends Ze{};Object.defineProperty(nt.prototype,"jsenType",{get:()=>"CallExpression"});var st=nt;const it=class{static parse(e,t,r={},n=it){if(r.meta||(r.meta={vars:[]}),e.length){for(var s=Object.values(t||n.grammars),i=0;i<s.length;i++){var o=r.meta&&K(r.meta.vars)?r.meta.vars.length:0,a=s[i].parse(e,(e,t)=>it.parse(e,t,r,n));if(a&&r.meta&&(a.meta||(a.meta={}),a.meta.vars=r.meta.vars.slice(o),(he(a,et)||he(a,st))&&(Le(a.meta.vars,a.context),Le(r.meta.vars,a.context),r.meta.vars.push(a))),a&&r.explain&&console.log(e," >>-------------\x3e> ",a.jsenType),(a instanceof Ye||a instanceof rt)&&(!r||!r.mutates))throw new Error("[Permission error:] "+e);if(a)return a}if(!1===r.assert)return;throw new Error("[Syntax error:] "+e)}}};var ot=it;const at=class{static lex(e,t,r){if(!Q(e))throw new Error("Argument1 must be a string!");var n=new at(e,r);return at.$cache[e]=at.$cache[e]||[],at.$cache[e].push(n),n.lex(t)}static split(e,t,r){return at.lex(e,t,r).tokens}static match(e,t,r){return at.lex(e,t,r).matches}constructor(e,t){if(!Q(e))throw new Error("Lexer requires the first argument to be a string.");this.$str=e,this.$options=t||{},this.$options.blocks||(this.$options.blocks=at.$blocks),this.$options.quotes||(this.$options.quotes=at.$quotes),this.$options.comments||(this.$options.comments=at.$comments),this.$cache=[]}lex(e,t){var r={delims:fe(e),options:R(!0,{},this.$options,t||{}),nesting:[],maxDepth:0,comments:[],tokens:[],matches:[],matchesi:{}};if(!1!==r.options.cache)for(var n=0;n<this.$cache.length;n++)if(H(this.$cache[n].delims,r.delims)&&H(this.$cache[n].options,r.options))return M(this.$cache[n]);if(this._evalCharsAt(r,0),r.nesting.length)throw new Error("Error parsing the string: "+this.$str+". Unterminated blocks: "+Pe(r.nesting).join(", "));return!1!==r.options.cache&&this.$cache.push(r),r}_evalCharsAt(e,t){if(!(t>=this.$str.length)){var r=1,n={},s={},i={};if(e.openComment||(s=this._testQuotes(e,t)),e.openQuote||(n=this._testComments(e,t)),e.openComment||n.ending)if(e.nesting.length||i.ending)this._push(e,this.$str[t]);else r=(a=n.starting||n.ending||this.$str[t]).length,this._push(e,a,"comments"),e.options.preserveComments&&this._push(e,a);else if(e.openQuote||s.ending)this._push(e,this.$str[t]);else{if(e.options.limit&&e.matches.length===e.options.limit)return this._push(e,this.$str[t]),this._evalCharsAt(e,t+1);i=this._testNesting(e,t);i=this._testNesting(e,t);var o=this._testChars(e.options.stopChars||[],e,t);if(!e.nesting.length&&!1!==o)return e.options.stopChar=o,void(e.options.stopCharForward=this.$str.substr(t));if(e.delims.length)if(e.nesting.length||i.ending){var a;r=(a=i.starting||i.ending||this.$str[t]).length,this._push(e,a)}else{this._push(e,"");var l=this._testChars(e.delims,e,t);if(!1!==l&&(e.matches.push(l),e.matchesi[t]=l,r=l.length||1,!e.options.preserveDelims))return this._evalCharsAt(e,t+(l.length||1));this._push(e,l||this.$str[t])}else 2===e.nesting.length&&i.starting?(e.matches.push(null),this._push(e,i.starting),r=i.starting.length):!e.nesting.length&&i.ending?(this._push(e,i.ending),r=i.ending.length,e.matches.push(null)):this._push(e,this.$str[t])}return this._evalCharsAt(e,t+r)}}_testQuotes(e,t){var r={};return(e.options.quotes||[]).forEach(n=>{this.$str.substr(t,1)===n&&(e.openQuote?n===e.openQuote&&(e.openQuote=!1,r.ending=n):(e.openQuote=n,r.starting=n))}),r}_testComments(e,t){var r={};return(e.options.comments||[]).forEach(n=>{if(e.openComment){if(me(n)===me(e.openComment)){var s;(s=this.$str.substr(t).match(new RegExp("^"+me(n))))&&(e.openComment=!1,r.ending=s[0])}}else(s=this.$str.substr(t).match(new RegExp("^"+de(n))))&&(e.openComment=n,r.starting=s[0])}),r}_testNesting(e,t){var r={};return(e.options.blocks||[]).forEach(n=>{var s=this.$str.substr(t).match(new RegExp("^"+de(n)));if(s)e.nesting=e.nesting.concat([n]),r.starting=s[0];else if(e.nesting.length&&me(n)===me(me(e.nesting))){var i=this.$str.substr(t).match(new RegExp("^"+me(n)));i&&(e.nesting=e.nesting.slice(0,-1),r.ending=i[0])}}),e.maxDepth=Math.max(e.maxDepth,e.nesting.length),r}_testChars(e,t,r){for(var n=0;n<e.length;n++){var s=e[n];if(t.options.useRegex){var i=this.$str.substr(r).match(new RegExp("^"+s,!0!==t.options.useRegex?t.options.useRegex:""));if(i)return i[0]}if(!t.options.ci&&this.$str.substr(r,s.length)===s||t.options.ci&&this.$str.substr(r,s.length).toLowerCase()===s.toLowerCase())return s}return!1}_push(e,t,r="tokens"){var n=e.matches.length;te(e[r][n])&&(e[r][n]=""),e[r][n]+=t}split(e,t,r){return this.lex(t,r).tokens}match(e,t,r){return this.lex(t,r).matches}regParse(e,t){return this.lex(e,R({useRegex:!0},t||{}))}regSplit(e,t){return this.regParse(e,t).tokens}regMatch(e,t){return this.regParse(e,t).matches}};at.$blocks=[["\\(","\\)"],["\\[","\\]"],["\\{","\\}"]],at.$quotes=['"',"'","`"],at.$comments=[["\\/\\*","\\*\\/"],["\\/\\/","(\\r)?\\n"]],at.$cache={};var lt=at,ct=class extends Array{};const pt=class extends Ze{};Object.defineProperty(pt.prototype,"jsenType",{get:()=>"Abstraction"});var ut=pt;const ht=class extends ut{constructor(e){super(),this.expr=e}eval(e=null,t=null){return this.expr.eval(e,t)}toString(e=null){return"("+this.expr.toString(e)+")"}static parse(e,t,r=ht){if(p(e,"(",")")&&!lt.match(e,[" "]).length)return new r(t(u(e,"(",")")))}};var ft=ht;const dt=class extends Ze{};Object.defineProperty(dt.prototype,"jsenType",{get:()=>"ArrayType"});var mt=dt;const gt=class extends mt{constructor(e){super(),this.exprs=e||[]}inherit(e){if(e instanceof mt){var t=e.exprs.filter(e=>this.exprs.reduce((t,r)=>t&&!e.even(r),!0));this.exprs=t.concat(this.exprs)}return this}eval(e=null,t=null){return this.exprs.map(r=>r.eval(e,t))}toString(e=null){return"["+this.exprs.map(t=>t.toString(e)).join(", ")+"]"}static parse(e,t,r=gt){if(p(e,"[","]")&&!lt.match(e.trim(),[" "]).length)return new r(lt.split(u(e,"[","]"),[","]).map(e=>e.trim()).filter(e=>e).map(e=>t(e)))}};var vt=gt;const bt=class extends Ze{};Object.defineProperty(bt.prototype,"jsenType",{get:()=>"Arguments"});var yt=bt;const wt=class extends yt{constructor(e=[]){super(),this.list=e}eval(e=null,t=null){return this.list.map(r=>r.eval(e,t))}toString(e=null){return"("+this.list.map(t=>t.toString(e)).join(", ")+")"}static parse(e,t,r=wt){if(e=e.trim(),p(e,"(",")")&&!lt.match(e,[" "]).length)return new r(lt.split(u(e,"(",")"),[","]).map(e=>t(e.trim())))}};var xt=wt;const $t=class extends Ze{};Object.defineProperty($t.prototype,"jsenType",{get:()=>"AssertionExpression"});var _t=$t;const Ct=class extends _t{constructor(e,t){super(),this.exprs=e,this.logic=t}eval(e=null,t=null){if("!"===this.logic)return!de(this.exprs).eval(e,t);Pe(Ct.operators);for(var r=(this.logic||"").trim().toUpperCase(),n=r===(Ct.operators.or||"").trim().toUpperCase(),s=r===(Ct.operators.nor||"").trim().toUpperCase(),i=r===(Ct.operators.and||"").trim().toUpperCase(),o=r===(Ct.operators.nand||"").trim().toUpperCase(),a=!0,l=0,c=0;c<this.exprs.length;c++){if(i&&!a)return!1;if(o&&!a)return!0;if(a=this.exprs[c].eval(e,t),n&&a)return a;l+=a?1:0}return n?a:i||o?i:s&&0===l}toString(e=null){return"!"===this.logic?"!"+de(this.exprs).toString(e):this.exprs.map(t=>t.toString(e)).join(" "+this.logic+" ")}static parse(e,t,r=Ct){if(e.startsWith("!"))return new r([t(e.substr(1))],"!");var n=lt.lex(e,Pe(r.operators));if(n.tokens.length>1){var s=Me(n.matches);if(s.length>1)throw new Error('"AND" and "OR" logic cannot be asserted in the same expression: '+e+"!");return new r(n.tokens.map(e=>t(e.trim())),de(s))}}};Ct.operators={and:"&&",or:"||"};var Ot=Ct;const Et=class extends Ye{constructor(e,t,r="="){super(),this.reference=e,this.val=t,this.operator=r}eval(e=null,t=null){var r=this.reference.getEval(e,t),n=this.val.eval(e,t);return!te(r.context)&&!te(r.name)&&(Y(t)?t(this,r.context,r.name,n):((r.context instanceof ct?me(r.context):r.context)[r.name]=n,!0))}toString(e=null){return[this.reference.toString(e),this.operator,this.val.toString(e)].join(" ")}static parse(e,t,r=Et){var n=lt.lex(e,r.operators);if(2===n.tokens.length){var s,i;if(!((s=t(n.tokens.shift().trim()))instanceof et&&(i=t(n.tokens.shift().trim()))))throw new Error("Invalid assignment directive: "+e);return new r(s,i,n.matches[0].trim())}}};Et.operators=[" = "];var jt=Et;const kt=class extends Ze{};Object.defineProperty(kt.prototype,"jsenType",{get:()=>"BooleanType"});var At=kt;const St=class extends At{constructor(e){super(),this.state=e}eval(){return"true"===this.state.toLowerCase().trim()}toString(){return this.state}static parse(e,t,r=St){if("true"===(e=e.toLowerCase().trim())||"false"===e)return new r(e)}};var Pt=St;const Tt=class extends st{constructor(e,t){super(),this.reference=e,this.args=t}eval(e=null,t=null){var r=this.reference.getEval(e,t),n=this.args.eval(e,t);if(!te(r.name)){if(Y(t))return t(this,r.context,r.name,n);for(var s=r.context instanceof ct?r.context.slice():[r.context],i=s.slice();s.length;){var o=s.pop();if(o&&Y(o[r.name]))return o[r.name](...n);var a=Tt.utils||{},l=G(o)&&a.Num?a.Num:Q(o)&&a.Str?a.Str:K(o)&&a.Arr?a.Arr:Z(o)&&a.Obj?a.Obj:null;if(l&&Y(l[r.name]))return n.unshift(o),l[r.name](...n)}throw new Error('"'+this+'" is not a function. (Called on '+i.map(e=>typeof e).join(", ")+")")}}toString(e=null){return this.reference.toString(e)+this.args.toString(e)}static parse(e,t,r=Tt){if(!e.startsWith("(")&&e.endsWith(")")&&!lt.match(e,[" "]).length){var n,s=lt.split(e,[]),i=s.pop();if(!((n=t(s.join("")))instanceof et&&(i=t(i,[xt]))))throw new Error("Invalid call directive: "+e);return new r(n,i)}}};var Mt=Tt;const Nt=class extends Ze{};Object.defineProperty(Nt.prototype,"jsenType",{get:()=>"Comments"});var Rt=Nt;const Lt=class extends Rt{constructor(e,t){super(),this.comments=e,this.type=t}eval(e=null,t=null){}toString(e=null){return""}static parse(e,t,r=Lt){var n=null,s=null,i=0,o="before";if(e.startsWith("//"))n=(a=lt.split(d(e,"//"),["\r\n"])).shift().trim(),s=a.shift().trim(),i=1;else if(e.startsWith("/*")){n=(a=lt.split(d(e,"/*"),["*/"])).shift().trim(),s=a.shift().trim(),i=2}else if(e.endsWith("*/")){var a;n=(a=lt.split(_beforeLast(e,"*/"),["/*"])).pop().trim(),s=a.pop().trim(),i=2;o="after"}if(i&&(2===i&&(n=lt.split(n.trim(),["\r\n"]).map(e=>e.replace(/^[\*]+/,"")).filter(e=>e.trim())),console.log(n,o,e),n=new r(n,i)),s)return(s=t(s)).meta.commenta=n,s}};var Dt=Lt;const Ht=class extends Ze{};Object.defineProperty(Ht.prototype,"jsenType",{get:()=>"ComparisonExpression"});var qt=Ht;const Bt=class extends qt{constructor(e,t,r){super(),this.operand1=e,this.operand2=t,this.operator=r}eval(e=null,t=null){return Bt.compare(this.operand1.eval(e,t),this.operand2.eval(e,t),this.operator)}toString(e=null){return[this.operand1.toString(e),this.operator,this.operand2.toString(e)].join(" ")}static parse(e,t,r=Bt){var n=Pe(r.operators).map(e=>" "+e+" "),s=lt.lex(e,n);if(s.tokens.length>1){if(s.tokens.length>2)throw new Error('Malformed "Comparison" expression: '+e+"!");return new r(t(de(s.tokens).trim()),t(me(s.tokens).trim()),s.matches[0].trim())}}static compare(e,t,r="=="){if(-1===Pe(Bt.operators).indexOf(r))throw new Error('The operator "'+r+'" is not recognized.');if(K(e)&&K(t)&&"==="!==r){if(e.length!==t.length)return!1;var n=!0;e.sort(),t.sort();for(var s=0;s<e.length;s++)n=n&&Bt.compare(e[s],t[s],r);return n}if(Z(e)&&Z(t)&&"==="!==r){var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length||ke(i,o).length)return!1;var a=!0;return $(i,(n,s)=>{a=a&&Bt.compare(e[s],t[s],r)}),a}switch(r){case"===":return e===t;case"==":case"=":return e==t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t;case"!=":return e!=t;case"!==":return e!==t;case"^=":return Q(e)&&e.startsWith(t);case"$=":return Q(e)&&e.endsWith(t);case"*=":return!(!K(t)&&!Q(t))&&e.indexOf(t)>-1;case"~=":return Q(e)&&Q(t)&&(" "+e+" ").indexOf(" "+t+" ")>-1;case">=<":if(!K(t)||2!==t.length)throw new Error("A 'Between' comparison requires argument 2 to be an array of exactly 2 values.");return e>=t[0]&&e<=t[1];case"/**/":return y(t,e);default:return!1}}static diff(e,t,r){return!Bt.compare(e,t,r?"===":"==")}};Bt.operators={exact:{is:"===",isNull:"===",equalsTo:"==",notEqualsTo:"!="},relative:{lesserThan:"<",greaterThan:">",lesserThanOrEqualsTo:"<=",greaterThanOrEqualsTo:">=",between:">=<"},partial:{startsWith:"^=",endsWith:"$=",contains:"*=",any:"~=",in:"~=",matches:"/**/"}};var Ft=Bt;const Wt=class extends Ze{};Object.defineProperty(Wt.prototype,"jsenType",{get:()=>"ConditionExpression"});var It=Wt;const Ut=class extends It{constructor(e,t,r){super(),this.assertion=e,this.onTrue=t,this.onFalse=r}eval(e=null,t=null){return this.assertion.eval(e,t)?this.onTrue.eval(e,t):this.onFalse.eval(e,t)}toString(e=null){return[this.assertion.toString(e),Ut.operators[0],this.onTrue.toString(e),Ut.operators[1],this.onFalse.toString(e)].join(" ")}static parse(e,t,r=Ut){var n=lt.split(e,r.operators);if(n.length>1){if(2===n.length)throw new Error("Malformed ternary expression: "+e+"!");return new r(t(n[0].trim()),t(n[1].trim()),t(n[2].trim()))}}};Ut.operators=["?",":"];var Qt=Ut;const zt=class extends rt{constructor(e,t="delete"){super(),this.reference=e,this.operator=t}eval(e=null,t=null){var r=this.reference.getEval(e,t);return!te(r.context)&&!te(r.name)&&(Y(t)?t(this,r.context,r.name):(delete(r.context instanceof ct?me(r.context):r.context)[r.name],!0))}toString(e=null){return this.operator+" "+this.reference.toString(e)}static parse(e,t,r=zt){var n=lt.lex(e,Object.values(r.operators));if(1===n.matches.length&&e.startsWith(n.matches[0]+" ")){var s;if(!((s=t(n.tokens.pop().trim()))instanceof et))throw new Error("Invalid delete directive: "+e);return new r(s,n.matches[0].trim())}}};zt.operators={red:"reduce",del:"delete"};var Gt=zt;const Kt=class extends Ze{};Object.defineProperty(Kt.prototype,"jsenType",{get:()=>"FunctionType"});var Jt=Kt;const Zt=class extends Jt{constructor(e,t,r={}){super(),this.paramters=e||{},this.statements=t,this.wrappings=r}inherit(e){if(e instanceof Jt){for(var t=Object.keys(e.paramters),r=Object.keys(this.paramters),n=0;n<Math.max(r.length,t.length);n++){var s=t[n],i=r[n];if(!i&&s)throw new Error("Parameter #"+n+" ("+s+") in parent function must be implemented.");if(i&&s){var o=e.paramters[s],a=this.paramters[i];if(a&&!o)throw new Error("Parameter #"+n+" ("+i+") must not have a default value as established in parent function.");if(a&&o&&a.jsenType!==o.jsenType)throw new Error("Default value for parameter #"+n+" ("+i+") must be of type "+o.jsenType+" as established in parent function.")}}this.sup=e}return this}eval(e=null,t=null){return(...r)=>{var n={};$(Object.keys(this.paramters),(s,i)=>{var o=this.paramters[i];if(r.length-1<s&&!o)throw new Error('The parameter "'+i+'" is required.');n[i]=r.length>s?r[s]:this.paramters[i]?this.paramters[i].eval(e,t):null});var s=new ct(n);return e instanceof ct?s=e.concat(s):e&&s.unshift(e),this.statements.eval(s,t)}}toString(e=null){var t=[];$(this.paramters,(r,n)=>{t.push(r+(n?"="+n.toString(e):""))});var r=!1===this.wrappings.head||1===t.length&&-1===t[0].indexOf("="),n=!1===this.wrappings.body;return(r?t[0]:"("+t.join(", ")+")")+" => "+(n?this.statements.toString(e):"{"+this.statements.toString(e)+"}")}static parse(e,t,r=Zt){var n=lt.split(e,Pe(r.operators));if(2===n.length){var s=n.shift().trim(),i=n.shift().trim(),o={};p(s,"(",")")?s=u(s,"(",")"):o.head=!1,p(i,"{","}")?i=u(i,"{","}"):o.body=!1;var a={};lt.split(s,[","]).forEach(e=>{var r=e.split("=");r[1]?a[r[0].trim()]=t(r[1].trim()):a[e.trim()]=null});var l=t(i);return new r(a,l,o)}}};Zt.operators=["=>"];var Vt=Zt;const Yt=class extends Ze{};Object.defineProperty(Yt.prototype,"jsenType",{get:()=>"MathExpression"});var Xt=Yt;const er=class extends Xt{constructor(e,t){super(),this.val=e,this.exprs=t}eval(e=null,t=null){return this.exprs.reduce((r,n)=>{var s=n.val.eval(e,t),i=n.operator.trim();if(!(G(r)&&G(s)||"+"===i))throw new Error("Invalid Math expression: "+this.toString()+"!");switch(i){case"+":return r+s;case"-":return r-s;case"*":return r*s;case"/":return r/s}},this.val.eval(e,t))}toString(e=null){return[this.val.toString(e)].concat(this.exprs.map(t=>t.operator+" "+t.val.toString(e))).join(" ")}static parse(e,t,r=er){var n=lt.lex(e,Pe(r.operators));if(n.tokens.length>1&&n.matches.length===n.tokens.length-1){var s=Me(n.matches);if(je(s,er.operators.sup).length&&je(s,er.operators.sub).length)throw new Error('"Addition/subtraction" and "multiplication/division" operators cannot be used in the same expression: '+e+"!");return new r(t(n.tokens.shift().trim()),n.tokens.map((e,r)=>({operator:n.matches[r],val:t(e.trim())})))}}};er.operators={sup:["*","/"],sub:[" + "," - "]};var tr=er;const rr=class extends Ze{};Object.defineProperty(rr.prototype,"jsenType",{get:()=>"NumberType"});var nr=rr;const sr=class extends nr{constructor(e,t=0){super(),this.int=e,this.dec=t}eval(){return parseFloat(this.int+(this.dec?"."+this.dec:null))}toString(e=null){return this.int+(this.dec?"."+this.dec:null)}static parse(e,t,r=sr){if(G(e)){e=e.split(".");return new r(parseInt(e.shift()),parseInt(e.shift()))}}};var ir=sr;const or=class extends Ze{};Object.defineProperty(or.prototype,"jsenType",{get:()=>"ObjectType"});var ar=or;const lr=class extends ar{constructor(e){super(),this.entries=e||{}}inherit(e){return e instanceof ar&&$(e.entries,(e,t)=>{e in this.entries||(this.entries[e]=t)}),this}eval(e=null,t=null){var r={};return $(this.entries,(n,s)=>{r[n]=s.eval(e,t)}),r}toString(e=null){var t=[];return $(this.entries,(r,n)=>{t.push(r+lr.operators.sub+n.toString(e))}),"{"+t.join(lr.operators.sup)+"}"}static parse(e,t,r=lr){if(p(e,"{","}")&&!lt.match(e.trim(),[" "]).length){var n={},s=lt.split(u(e,"{","}"),[lr.operators.sup]).map(e=>e.trim()).filter(e=>e);return $(s,(e,r)=>{var s=lt.split(r,[lr.operators.sub],{limit:1});n[de(s).trim()]=t(me(s).trim())}),new r(n)}}};lr.operators={sup:",",sub:":"};var cr=lr;const pr=class extends et{constructor(e,t,r=!1){super(),this.context=e,this.name=t,this.backticks=r}getEval(e=null,t=null){var r=e,n=this.name;return this.context&&(n instanceof Ze&&(n=n.eval(e,t)),r=this.context.eval(e,t)),{context:r,name:n}}eval(e=null,t=null){var r=this.getEval(e,t);if(!te(r.context)&&!te(r.name)){if(Y(t))return t(this,r.context,r.name);for(var n=r.context instanceof ct?r.context.slice():[r.context];n.length;){var s=n.pop()[r.name];if(!te(s))return s}}}toString(e=null){var t=this.name;if(this.context){var r=this.context.toString(e);t instanceof Ze?t="["+t.toString(e)+"]":this.backticks&&(t="`"+t+"`")}else{r=e;this.backticks&&(t="`"+t+"`")}return(r||"")+(r&&!t.startsWith("[")?pr.separator:"")+t}static parse(e,t,r=pr){if(!lt.match(e.trim(),[" "]).length){var n,s,i=lt.split(e,[]),o=i.pop(),a=lt.split(o.trim(),[r.separator],{preserveDelims:!0});if(a.length>1&&(o=a.pop().substr(1),i=i.concat(a)),p(o,"`","`")&&(o=u(o,"`","`"),s=!0),i.length&&((n=t(i.join(""))).isContext=!0),p(o,"[","]")){if(!n)throw new Error("Invalid reference: "+e+"!");o=t(u(o,"[","]"))}return new r(n,o,s)}}};pr.separator=".";var ur=pr;const hr=class extends Ze{};Object.defineProperty(hr.prototype,"jsenType",{get:()=>"ReturnDirective"});var fr=hr;const dr=class extends fr{constructor(e){super(),this.expr=e}eval(e=null,t=null){return this.expr?this.expr.eval(e,t):void 0}toString(e=null){return this.expr?"return "+this.expr.toString(e):"return"}static parse(e,t,r=dr){var n=e.toLowerCase();if(n.startsWith("return ")||"return"===n)return new r(t(e.substr(6).trim()))}};var mr=dr;const gr=class extends Ze{};Object.defineProperty(gr.prototype,"jsenType",{get:()=>"Statements"});var vr=gr;const br=class extends vr{constructor(e,t){super(),this.stmts=exprs,this.delim=t}eval(e=null,t=null){for(var r=[],n=0;n<this.stmts.length;n++){if(this.stmts[n]instanceof fr)return this.stmts[n].eval(e,t);r[n]=this.stmts[n].eval(e,t)}return r}toString(e=null){return this.stmts.map(t=>t.toString(e)).join(this.delim)}static parse(e,t,r=br){var n=lt.lex(e,Pe(r.operators));if(n.tokens.length>1)return new r(n.tokens.map(e=>t(e)),n.matches[0].trim())}};br.operators=[";","\r\n"];var yr=br;const wr=class extends Ze{};Object.defineProperty(wr.prototype,"jsenType",{get:()=>"StringType"});var xr=wr;const $r=class extends xr{constructor(e,t){super(),this.expr=e,this.quote=t}eval(){return this.expr}toString(){return this.quote+this.expr+this.quote}static parse(e,t,r=$r){if(e=e.trim(),(p(e,'"','"')||p(e,"'","'"))&&!lt.match(e,[" "]).length){var n=p(e,'"','"')?'"':"'";return new r(u(e,n,n),n)}}};var _r=$r;const Cr=function(e,t,r=!1){var n=null,s=e;(r||Z(s))&&(n=Object.keys(s),s=n.map(e=>s[e]));var i=s.reduce((e,r)=>Math.abs(r-t)<Math.abs(e-t)?r:e,void 0);return n?n[s.indexOf(i)]:i},Or=function(e){var t=strtr(e,{zero:"0",a:"1",one:"1",two:"2",three:"3",four:"4",five:"5",six:"6",seven:"7",eight:"8",nine:"9",ten:"10",eleven:"11",twelve:"12",thirteen:"13",fourteen:"14",fifteen:"15",sixteen:"16",seventeen:"17",eighteen:"18",nineteen:"19",twenty:"20",thirty:"30",forty:"40",fourty:"40",fifty:"50",sixty:"60",seventy:"70",eighty:"80",ninety:"90",hundred:"100",thousand:"1000",million:"1000000",billion:"1000000000",and:""}).split("/[s-]+/").map(e=>parseFloat(e)),r=null,n=0,s=null;return $(t,(e,t)=>{""!==r?r>t?s>=1e3?(n+=r,r=t):r+=t:r*=t:r=t,s=t}),n+r},Er=(e,t,r="")=>Object.keys(e).reduce((t,n)=>x(t,r+n,(function(){return e[n](this,...arguments)})),t),jr=(e,t={})=>Object.keys(e).reduce((t,r)=>x(t,r.substr(1),e[r]),t),kr=jr(a),Ar=jr(o),Sr=jr(l),Pr=jr(s),Tr=jr(n);ot.grammars={Comments:Dt,Return:mr,Statements:yr,Deletion:Gt,Assignment:jt,Func:Vt,Abstraction:ft,Condition:Qt,Assertion:Ot,Comparison:Ft,Math:tr,Arr:vt,Obj:cr,Num:ir,Str:_r,Bool:Pt,Call:Mt,Reference:ur},Mt.utils=c;var Mr=ot;var Nr=class{constructor(e){this.$={isPropagationStopped:!1,isDefaultPrevented:!1,promises:[]},$(e,(e,t)=>{this[e]=t})}stopPropagation(){this.$.isPropagationStopped=!0}get isPropagationStopped(){return this.$.isPropagationStopped}preventDefault(){this.$.isDefaultPrevented=!0}get isDefaultPrevented(){return this.$.isDefaultPrevented}promise(e){if(!(e instanceof Promise))throw new Error("Event.promise() must be called with a Promise.");this.$.promises.push(e)}get promises(){return this.$.promises.length?Promise.all(this.$.promises):null}};var Rr=class{constructor(){this.$={listeners:[]}}addListener(e,t,r={},n=null){if(Y(e)&&(n=arguments.length>2?r:"",r=t,t=e,e=null),!Y(t))throw new Error('Callback must be a function; "'+ie(t)+'" given!');var s={eventNames:e,callback:t,params:r,tag:n,remove:()=>{Le(this.$.listeners,s)}};return this.$.listeners.push(s),s}removeListener(e,t=null,r={},n=null){Y(e)&&(n=arguments.length>2?r:"",r=t||{},t=e,e=null);for(var s=!1,i=0;i<this.$.listeners.length;i++)!ne(e)&&!H(fe(this.$.listeners[i].eventNames),fe(e))||!ne(t)&&this.$.listeners[i].callback!==t||!ne(r)&&!H(this.$.listeners[i].params,r)||!ne(n)&&this.$.listeners[i].tag!==n||(this.$.listeners[i].removeCallback&&this.$.listeners[i].removeCallback(),this.$.listeners[i].remove(),s=!0);return s}eventsAll(){var e=[];return(this.$.listeners||[]).forEach(t=>{ne(t.eventNames)||(e=Re(e,fe(t.eventNames)))}),e}fire(e,t){var r=t instanceof Nr?t:new Nr(t);e=fe(e),this.$.currentlyFiring=this.$.currentlyFiring||[];var n=ke(e,this.$.currentlyFiring);if(n.length){Re(this.$.currentlyFiring,n);for(var s=0;s<(this.$.listeners||[]).length;s++)if(!r.isPropagationStopped){var i=this.$.listeners[s],o=i.params||{},a=fe(i.eventNames).map(e=>e.replace(/\`/g,""));if((a.length?a.filter(e=>(r.bubbling&&e.indexOf(".")>-1?r.bubbling:!r.bubbling||o.allowBubbling?n:[]).filter(t=>(e+".").startsWith(t+".")).length).length:!r.bubbling||o.allowBubbling)&&this._shouldFire(i,e,r)){var l,c=this._doFire(i,e,r);!1===c||c instanceof Nr&&c.isPropagationStopped?r.stopPropagation():!1===c||c instanceof Nr&&c.isDefaultPrevented?r.preventDefault():(c instanceof Promise&&(l=c)||c instanceof Nr&&(l=c.promises))&&r.promise(l)}}return De(this.$.currentlyFiring,...n),r}}_shouldFire(e,t,r){return!0}_doFire(e,t,r){var n=r.context||{},s=r._context||{};if(!ne(e.eventNames)){var i=[],o=[];fe(e.eventNames).forEach(e=>{e=Q(e)?e.split("."):e,i.push(_(n,e)),o.push(_(s,e))});return K(e.eventNames)?e.callback(i,o,r):e.callback(i[0],o[0],r)}i={},o={};return t.forEach(e=>{var t=Q(e)?e.split("."):e;i[e]=_(n,t),o[e]=_(s,t)}),e.callback(i,o,r)}};const Lr=class extends Rr{constructor(e={},t={}){super(),this.$.params=L({},t,Lr.params),this.$.bubblers={},this.$.state=e,this.$._state=K(e)?e.slice():N(1,e),$(this.$.state,(e,t)=>{this._incoming(e,t)})}setOffsetParent(e){this.$.offsetParent=e}getOffsetParent(){return this.$.offsetParent}observe(...e){return this.addListener(...e)}unobserve(...e){return this.removeListener(...e)}set(e,t){var r={};Q(e)||z(e)?r[e]=t:K(e)?e.forEach(e=>{r[e]=t}):Z(e)&&(r=e);var n=Object.keys(r);K(this.$.state)&&(n=n.map(e=>parseInt(e)));var s=[];n.forEach(e=>{e in this.$.state?this._outgoing(e,this.$.state[e]):s.push(e);var t=r[e];if(le(t)){var n=ce(t);oe(n)&&(t=n)}this._incoming(e,t),this.$.state[e]=t});var i=this.fire(n,{context:this.$.state,_context:this.$._state,entries:s,exits:[]});return n.forEach(e=>{this.$._state[e]=this.$.state[e]}),i}del(e){var t=fe(e),r=[];t.forEach(e=>{e in this.$.state&&(r.push(e),this._outgoing(e,this.$.state[e])),delete this.$.state[e]});var n=this.fire(t,{context:this.$.state,_context:this.$._state,entries:[],exits:r});return t.forEach(e=>{delete this.$._state[e]}),n}asOwnMethod(e){if(Q(e)&&this.$.params.methodPrefix&&e.startsWith(this.$.params.methodPrefix)){var t=e.substr(this.$.params.methodPrefix.length);if(t&&Y(t=this[t]))return t.bind(this)}}get(e){var t=this.asOwnMethod(e);if(t)return t;if("_"===e)return this.getOffsetParent();if("__"===e){var r=this.getOffsetParent();return(r?r.get("__"):r)||r}var n=this.$.state[e];return K(this.$.state)&&!G(e)&&Y(n)?(...e)=>{var t=this.$.state.slice(),r=n.apply(this.$.state,e),s=Me(Object.keys(t).concat(Object.keys(this.$.state))).filter(e=>{if(e=parseInt(e),this.$.state[e]!==t[e])return e in this.$.state?this._incoming(e,this.$.state[e]):this._outgoing(e,t[e]),!0});return s.length&&(this.fire(s,{context:this.$.state,_context:this.$._state}),this.$._state=this.$.state.slice()),r}:n}has(e){return e in this.$.state}keys(){return Object.keys(this.$.state)}jsenEval(e,t={}){var r=Mr.parse(e,null,t);if(r)return r.eval(this,this.jsenGetter())}jsenGetter(e=[]){return(t,r,n,s=[])=>{if(t instanceof st||t instanceof et){t.isContext||e.push(t);for(var i,o=!0,a=r instanceof ct?r.slice():[r],l=a.slice();te(i)&&o&&a.length;){var c=a.pop();oe(c)?i=c.get(n):c&&(i=c[n]),t instanceof st&&!te(i)&&(Y(i)||this.error(n+"() is not callable in the expression "+t.toString()+"!"),i=i.apply(c,s),o=!1)}return o&&t instanceof st&&this.error('"'+t+'" is not a function. (Called on '+l.map(e=>typeof e).join(", ")+")"),i}this.error('Operation "'+t+'" is not supported!')}}_shouldFire(e,t,r){var n=0,s=0;"CACHE"in r.$||(r.$.CACHE={},r.$._CACHE={});var i=e.params||{};return(ne(e.eventNames)?t:fe(e.eventNames)).forEach(e=>{if(!(e in r.$.CACHE)){r.$.CACHE[e]={},r.$._CACHE[e]={};var t={},o={},a=Q(e)?e.split("."):e;r.$.CACHE[e].val=_(r.context,a,t),r.$._CACHE[e].val=_(r._context,a,o),r.$.CACHE[e].existence=t.exists,r.$._CACHE[e].existence=o.exists,!1===i.diff||"diffing"in r.$.CACHE[e]||(r.$.CACHE[e].diffing=r.bubbling||r.$.CACHE[e].existence!==r.$._CACHE[e].existence||(Z(r.$.CACHE[e].val)&&Z(r.$._CACHE[e].val)?!H(r.$.CACHE[e].val,r.$._CACHE[e].val):r.$.CACHE[e].val!==r.$._CACHE[e].val))}G(i.pulse)&&r.context&&r._context&&(0===i.pulse&&r.$.CACHE[e].val&&!r.$._CACHE[e].val?s++:1===i.pulse&&!r.$.CACHE[e].val&&r.$._CACHE[e].val&&s++),(!1===i.diff||r.$.CACHE[e].diffing)&&n++}),!s&&n&&super._shouldFire(e,t,r)}_outgoing(e,t){oe(t)&&(e in this.$.bubblers&&t.unobserve(this.$.bubblers[e],{allowBubbling:!0}),Y(t.getOffsetParent)&&t.getOffsetParent()===this&&t.setOffsetParent(null))}_incoming(e,t){oe(t)&&(t.observe(this._getBubbler(e),{allowBubbling:!0}),Y(t.getOffsetParent)&&!t.getOffsetParent()&&t.setOffsetParent(this))}_getBubbler(e){return this.$.bubblers=this.$.bubblers||{},this.$.bubblers[e]=(t,r,n)=>{var s={};return s.context=this.$.state,s._context=this.$._state,s.entries=(n.entries||[]).slice(),s.exits=(n.exits||[]).slice(),s.bubbling=(n.bubbling?fe(n.bubbling):Object.keys(t)).map(t=>e+"."+t),this.fire(e,s)},this.$.bubblers[e]}warn(e){console.error(e)}error(e){if(this.$.params.strictDebug)throw new Error(e);console.error(e)}proxy(){return ae(this,{get:function(e,t){var r=e.get(t);return Z(r)&&Y(r.proxy)&&(r=r.proxy()),r},set:function(e,t,r){return e.set(t,r),!0},has:function(e,t){return e.has(t)},deleteProperty:function(e,t){return e.del(t)},ownKeys:function(e){return Object.keys(e.$.state)},defineProperty:function(e,t,r){return Object.defineProperty(e.$.state,t,r),e.set(t,e.$.state[t]),!0},getOwnPropertyDescriptor:function(e,t){return Object.getOwnPropertyDescriptor(e.$.state,t)},getOwnPropertySymbols:function(e){return Object.getOwnPropertySymbols(e.$.state)},getOwnPropertyNames:function(e){return Object.getOwnPropertyNames(e.$.state)}})}};Lr.params={methodPrefix:"$"};var Dr=Lr;const Hr=class{constructor(e,t,r=null){this.key=e,this.value=t,this.flag=r}toString(e=null){return this.key+": "+this.value+(this.flag?" "+this.flag:"")}static parse(e,t={}){if(e){var r=N(t);r.limit=1;var n=lt.split(e,[":"],r);if(n.length<2)throw new Error("Malformed def: "+e);var s,i,o=n.shift().trim(),a=lt.split(n.shift().trim(),[" "],t);return a.length>1&&Hr.flags.includes(me(a).trim().toLowerCase())&&(i=a.pop().trim().toLowerCase()),s=a.join(" "),new Hr(o,s,i)}}};Hr.flags=["!replace","!incase"];var qr=Hr;const Br=class{constructor(e=[]){this.entries=[],e.forEach(e=>this.add(e))}filter(e=!1,t=!1){return this.entries.filter(r=>(!r.isDuplicate||e)&&(!r.overridden||t))}toString(e=null,t=!1,r=!0){return this.filter(t,r).map(t=>t.toString(e)).join("; ")+";"}add(e){if(!e.key||!e.value)throw new Error("Def must contain a valid key and value!");return e instanceof qr||(e=new qr(e.key,e.value,e.flag)),this.entries.forEach(t=>{if(!t.isDuplicate&&!t.overridden){var r=t.key.toString(),n=t.value.toString(),s=p(n,"(",")")?u(n,"(",")"):n,i=e.key.toString(),o=e.value.toString(),a=p(o,"(",")")?u(o,"(",")"):o,l="!incase"===(t.flag||"").toLowerCase(),c="!replace"===(t.flag||"").toLowerCase(),h="!incase"===(e.flag||"").toLowerCase(),f="!replace"===(e.flag||"").toLowerCase();r===i&&(n!==o&&s!==a||c!==f&&l!==h?f||l?t.overridden=!0:(c||h)&&(e.overridden=!0):e.isDuplicate=!0)}}),this.entries.push(e),this}static parse(e,t={}){return new Br(lt.split(e,[";"],t).filter(e=>e.trim()).map(e=>qr.parse(e.trim())))}};var Fr=Br;const Wr=class{constructor(e={}){this.block={},this.apply(e)}toString(e=null,t=!1,r=!0){var n=[];return $(this.block,(s,i)=>{n.push("@"+s),n.push("{"+i.toString(e,t,r)+"}")}),n.join(" ")}apply(e){var t=e;if(e instanceof Wr)t=e.block;else if(!Z(e))throw new Error("Argument #1 must only be an object or an instance of ./DefSheet!");return $(t,(e,t)=>{this.applyTo(e,t)}),this}applyTo(e,t){var r=t;if(t instanceof Fr)r=t.entries;else if(!K(t))throw new Error("Argument #1 must only be an array or an instance of ./DefBlock!");return this.block[e]||(this.block[e]=new Fr),r.forEach(t=>this.block[e].add(N(t))),this}static parse(e,t={}){for(var r,n,s=lt.split(e,[],t),i={};(r=s.shift())&&(n=s.shift());)i[r.trim().toLowerCase().substr(1)]=Fr.parse(u(n.trim(),"{","}"),t);return new Wr(i)}};var Ir=Wr;const Ur=class extends Dr{constructor(e,t={}){if(super({},t),this.root=this.el=e,"#document"===e.nodeName)this.el=e.querySelector("html");else if(!(e instanceof HTMLElement))throw new Error("Argument #1 must be instanceof of HTMLElement or the document object!");this.$.ns=Ur.parseNamespace(this.el),this.$.defs=Ur.parseCascadedDefSheet(this.el),this.init()}init(){this.free(!1),this.getCpsBlock("init",!0).forEach(e=>e.eval(this)),this.$.bindingsListeners=[];return this.getCpsBlock("bindings",!0).forEach(e=>{this.$.params.observeOnly||e.eval(this,this.jsenGetter());var t,r=this.observe((t=e.meta.vars,Me(t.map(e=>h(h(e.toString(),"["),"(")))),(t,r,n)=>{var s=e.eval(this,this.jsenGetter());if(!1!==s)return s},{diff:this.$.params.diff});this.$.bindingsListeners.push(r)}),this}free(e=!0){return e?super.removeListener():this.$.bindingsListeners&&(this.$.bindingsListeners.forEach(e=>e.remove()),this.$.bindingsListeners.splice()),this}clone(e=!0){if(!Y(this.$.params.componentCallback))throw new Error("The params.componentCallback function is required!");var t,r=this.el.cloneNode(!0),n={};[Ur.attributeMap.related,Ur.attributeMap.bindings].forEach(e=>{var t;(t=r.getAttribute(e))&&(n.type=t,r.removeAttribute(e))}),(t=fe(r.children).filter(e=>e.matches(Ur.elementMap.defsheet))[0])&&t.remove();var s=this.$.params.componentCallback(r,this.$.params,!1);return(le(s)?ce(s):s).$defs=Ir.parse(this.$.defs.toString(null,!e,!0)),$(n,(e,t)=>{r.setAttribute(e,t)}),t&&r.prepend(t),s}getCpsBlock(e,t=!1){var r=this.$.defs.block[e]?this.$.defs.block[e].filter():[];if(t){var n=[];return r.forEach(e=>{var t=(!1!==this.$.params.chainableDirectives&&e.value.trim().startsWith("(")?lt.split(e.value,["."]):[e.value]).map(e=>Mr.parse(e,[xt],{assert:!1})||Mr.parse(e));if(t.length===t.filter(e=>e).length){var r,s=e.key+(t.length>1||t[0]instanceof yt?t.join("."):"("+t[0].toString()+")");(r=Mr.parse(s,null,{explain:this.$.params.explainJsen}))?n.push(r):this.error("Malformed CPS expression: "+e.toString())}else this.error("Malformed argument in the CPS expression: "+e.toString())}),n}return r}getRelatedNode(e){var t,r;if(this.computedRelated||(this.computedRelated={},this.getCpsBlock("related",!1).forEach(e=>{this.computedRelated[e.key]=Mr.parse(e.value)})),(t=this.computedRelated[e])&&(r=t.eval(this,this.jsenGetter([])))){if(Y(r)&&(r=r(this.el,e),!(Q(r)||r instanceof HTMLElement)))throw new Error('The callback for node "'+e+'" returned an invalid type.');if(Q(r)&&(r=Ur.toElement(r)),!(r instanceof HTMLElement))throw new Error('"'+e+'" could not be resolved to a valid node instance.');return r}}getExplicitNode(e){if(this.$.roles&&this.$.roles.length||(this.$.roles=(this.el.getAttribute(Ur.attributeMap.superrole)||"").replace("  "," ").split(" ")).length)return(this.$.params.rolecase?[this.$.params.rolecase]:this.$.roles).reduce((t,r)=>{if(!t){var n,s,i="["+Ur.attributeMap.superrole+'~="'+r+'"]',o="["+Ur.attributeMap.subrole+'~="'+r+"-"+e+'"]';(s=(this.el.shadowRoot||this.el).querySelector(o))&&(this.el.shadowRoot&&(!s.parentNode.closest||!s.parentNode.closest(i))||!this.el.shadowRoot&&s.parentNode&&(n=s.parentNode.closest(i))&&n.isSameNode(this.el))&&(t=s)}return t},null)}getImplicitNode(e){if(!e.match(/[^a-zA-Z0-9\-]/)){var t=[];Ur.schema.aria[e]?t.push({schema:Ur.schema.aria[e],selector:['[role="'+e+'"]']}):t.push({schema:Ur.schema.std[e]||Ur.schema.aria[e],selector:[e,'[role="'+e+'"]']}),$(Ur.schema.std,(r,n)=>{n.implicitRole===e&&t.push({schema:n,selector:[r]})});var r=null;return t.forEach(e=>{(this.el.shadowRoot||this.el).querySelectorAll(e.selector.join(",")).forEach(t=>{Ur.schema.assertNodeBelongsInScopeAs(this.el,t,e.schema)&&(e.schema&&e.schema.singleton?r=t:r&&!K(r)||(r=r||[]).push(t))})}),r}}createNode(e,t){var r=t;if(this.$.params.drilldown){if(t===this.root||t===this.el)t=this;else if(t){if(!Y(this.$.params.componentCallback))throw new Error("The params.componentCallback function is required!");var n=N(this.$.params);n.alias=e,t=K(t)?t.map(e=>this.$.params.componentCallback(e,n,!0)):this.$.params.componentCallback(t,n,!0)}}else Y(this.$.params.nodeCallback)&&(t=K(t)?t.map(e=>this.$.params.nodeCallback(e)):this.$.params.nodeCallback(t));return this.set(e,t),r&&r!==this.root&&r!==this.el&&!K(r)&&Ur.disconnectedCallback(r,()=>{this.del(e)}),t}get(e){var t,r=this.asOwnMethod(e);return r||("_"===e||"__"===e?super.get(e):"root"===e&&(t=this.root)||"el"===e&&(t=this.el)?Y(this.$.params.nodeCallback)?this.$.params.nodeCallback(t):t:(e in this.$.state||((t=this.getRelatedNode(e))||!this.$.params.implicitOnly&&(t=this.getExplicitNode(e))||!this.$.params.explicitOnly&&(t=this.getImplicitNode(e)))&&this.createNode(e,t),this.$.state[e]))}static parseNamespace(e){var t={roadmap:e.getAttribute(Ur.attributeMap.ns)};return t.roadmap&&(t.namespace=h(t.roadmap,"//"),t.subnamespace=d(t.roadmap,"//"),t.subnamespace.startsWith("/")&&(t.subnamespace=d(t.subnamespace,"/")),t.subnamespace.endsWith("//")&&-1===t.subnamespace.indexOf("///")&&(t.subnamespace=t.subnamespace+t.namespace+"//")),t}static parseCascadedDefSheet(e){var t,r,n,s;return(t=fe(e.children).filter(e=>e.matches(Ur.elementMap.defsheet))[0])&&(r=Ir.parse((t.textContent||"").trim()))||(r=new Ir),["related","bindings"].forEach(t=>{(n=e.getAttribute(Ur.attributeMap[t]))&&(s=Fr.parse(n))&&r.applyTo(t,s)}),r}static recompose(e,t){if(e.matches(Ur.elementMap.import)){t=t.cloneNode(!0);var r=e.getAttribute(Ur.attributeMap.ns),n=t.getAttribute(Ur.attributeMap.ns),s=(t.getAttribute(Ur.attributeMap.superrole)||"").split(" ").map(e=>e.trim());return t.setAttribute(Ur.attributeMap.ns,r),Ur.recomposeDefs(t,e,"append"),fe((e.shadowRoot||e).children).forEach((e,i)=>{if(!e.matches(Ur.elementMap.defsheet)){e=e.cloneNode(!0);var o=[],a=[];if((e.getAttribute(Ur.attributeMap.subrole)||"").split(" ").map(e=>e.trim()).forEach(e=>{var t=s.filter(t=>e.startsWith(t+"-"));t.length&&(o.push(t[0]),a.push(e))}),o.length){var l,c=o.map(e=>"["+Ur.attributeMap.superrole+'~="'+e+'"]'),p=a.map(e=>"["+Ur.attributeMap.subrole+'~="'+e+'"]');if(!(t.shadowRoot&&(l=t.shadowRoot.querySelectorAll(p))||1===(l=t.querySelectorAll(p)).length&&l[0].closest(c)===t))return void this.error("Composition Error: Node #"+i+" (at "+r+") must match exactly one targetNode in "+n+"! ("+l.length+" matched)");Ur.recomposeDefs(e,l[0],"prepend"),l[0].replaceWith(e)}else t.append(e)}}),t}return Ur.recomposeDefs(e,t,"prepend"),e}static recomposeDefs(e,t,r,n=[]){if(n=n.concat([Ur.attributeMap.ns,...Ur.attributeMap.nocompose]),e.hasAttribute("norecompose")&&(n=n.concat((e.getAttribute("norecompose")||"*").split(" ").map(e=>e.trim()))),Y(Ur.recomposeCallback)){var s=Ur.recomposeCallback(e,t,r,n);if(!1===s)return!1;(Q(s)||K(s))&&(n=n.concat(s))}Me([Ur.attributeMap.superrole,Ur.attributeMap.subrole,"role","class"]).forEach(s=>{var i,o;if(!n.includes(s)&&!n.includes("*")&&(i=t.getAttribute(s))){if(o=e.getAttribute(s))var a="prepend"===r?[i,o]:[o,i];else a=[i];e.setAttribute(s,Me(a.join(" ").split(" ").map(e=>e.trim())).join(" ")),n.push(s)}}),[Ur.attributeMap.related,Ur.attributeMap.bindings,"style"].forEach(s=>{var i,o;if(!n.includes(s)&&!n.includes("*")&&(i=t.getAttribute(s))){if(o=e.getAttribute(s))(a="prepend"===r?[i,o]:[o,i])[0].trim().endsWith(";")||(a[0]=a[0]+";");else var a=[i];e.setAttribute(s,a.join(" ")),n.push(s)}});for(var i=0;i<t.attributes.length;i++){var o=t.attributes[i];n.includes(o.name)||n.includes("*")||e.hasAttribute(o.name)||(e.setAttribute(o.name,o.value),n.push(o.name))}if(!n.includes("@cps")&&!n.includes("*")){var a=fe((e.shadowRoot||e).children).filter(e=>e.matches(Ur.elementMap.defsheet)),l=fe((t.shadowRoot||t).children).filter(e=>e.matches(Ur.elementMap.defsheet));l.length&&(a.length?a[0][r](l[0].textContent):e.prepend(l[0].cloneNode(!0)))}return!0}static toElement(e){if(Ur.ctxt.document){var t;if(e.trim().startsWith("<")){var r=Ur.ctxt.document.createElement("div");r.innerHtml=e,t=r.firstChild}else t=Ur.ctxt.document.querySelector(e);return t}}static disconnectedCallback(e,t){if(e.parentNode){var r=!1;new MutationObserver(n=>{n.forEach(n=>{!r&&fe(n.removedNodes).includes(e)&&(r=!0,t())})}).observe(e.parentNode,{childList:!0}),Ur.disconnectedCallback(e.parentNode,()=>{r||(r=!0,t())})}}};Ur.ctxt={},Ur.schema=Ge,Ur.elementMap={defsheet:'script[type="text/jsen-p"]',bundle:"chtml-bundle",import:"chtml-import"},Ur.attributeMap={ns:"chtml-ns",related:"chtml-related",bindings:"chtml-directives",superrole:"chtml-role",subrole:"chtml-role",nocompose:["nocompose","shadow"]};var Qr=Ur;const zr=class extends Qr{constructor(e,t={}){super(e,L({},t,zr.params)),this.observe(this.$.params.dataKey,(e,t)=>{!this.$.ns.subnamespace||Q(e)||z(e)||te(e)||(this.populate(e,this.$.ns.subnamespace,this.$.params.itemCallback),oe(e)&&e.observe(t=>{this.populate(e,this.$.ns.subnamespace,this.$.params.itemCallback,Object.keys(t))}))})}bind(e){return this.set(this.$.params.dataKey,e),this}populate(e,t,r=null,n=[]){oe(e)&&!le(e)&&(e=e.proxy()),(arguments.length>3?n:Object.keys(e)).forEach(n=>{n=G(n)?parseInt(n):n;var s=this.has(n)?this.get(n):null;if(te(e[n])){if(s)if(Y(r)){var i=r(s,!1,n);"Promise"in Qr.ctxt&&i instanceof Qr.ctxt.Promise?i.then(()=>{s.el.remove()}).catch(()=>{s.el.remove()}):s.el.remove()}else s.free(),s.el.remove()}else{var o=!1;if(!s){var a=t.split("//");a[0]+="/"+n;var l=zr.import(a.join("//"));if(l){var c=_e(Object.keys(e),n+"",!0).reduce((e,t)=>e||(this.has(t)?this.get(t):null),null);c?c.el.before(l):this.el.append(l),s=this.createNode(n,l),o=!0}}s&&(Y(r)?r(s,e[n],n,o):s.bind(e[n]))}})}static from(e,t={},r=!0,n=zr){var s=e;if(Q(e)&&!e.trim().startsWith("<")&&-1!==e.indexOf("/")){if(!Qr.bundles||!(s=zr.import(h(e,"//"))))throw new Error('No element found on the namespace "'+e+'"!')}else{if(Q(e)&&!(s=Qr.toElement(e)))throw new Error('Could not resolve the string "'+e+'" to an element!');if(r&&Qr.bundles){var i,o,a,l=s.matches(Qr.elementMap.import);if((i=h(s.getAttribute(Qr.attributeMap.ns)||"","//"))&&(l&&(o=i)||(o=f(i,"/"))&&o.indexOf("/")>-1)&&(a=zr.import(o))){var c=s;s=Qr.recompose(s,a),l&&c.replaceWith(s)}else i&&console.warn("Namespace resolution failed: "+i)}}return new n(s,t)}static import(e){return Qr.bundles.find(e)}};zr.params={diff:!0,dataKey:"$",drilldown:!1,nodeCallback:null,componentCallback:zr.from,observeOnly:!1};var Gr=zr;Qr.ctxt=window;var Kr=new Promise(e=>{"complete"!==document.readyState?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):e()});Qr.ready=(e,t=!0)=>{Kr.then(()=>{t?Qr.initObj.loadingBundlesPromise.then(e):e()})},Kr.then(()=>{var e,t,r,n,s;Qr.initObj=(e=fe(document.querySelectorAll('template[is="'+Qr.elementMap.bundle+'"]')).reverse(),t=e.filter(e=>e.hasAttribute("src")&&!e.content.children.length),r=t.map(e=>new Promise(t=>{e.addEventListener("bundleloadsuccess",t),e.addEventListener("bundleloaderror",t)})),n=Promise.all(r).then(()=>{r.splice(0)}),{contentLoadedPromise:Kr,loadingBundlesPromise:n,bundles:e,remoteBundles:t,loadingBundles:r});var i=[];Qr.bundles=new Je(Qr.initObj.bundles,[],(e,t,r,n)=>{Qr.initObj.loadingBundles.length&&!s&&(s=!0,console.warn("Remote bundles are still loading at this time! You should probabbly wrap bundle-dependent code within Chtml.ready(callback[, true/*waitForBundles*/])."));var o=t.join("/");if(i.includes(o))return Qr.bundles.find(t.slice(0,-1).join("/"));i.push(o);var a=e.content.querySelector("["+Qr.attributeMap.ns+'="'+o+'"]');if(a&&r){try{var l=[];e.hasAttribute("norecompose")&&(l=(e.getAttribute("norecompose")||"*").split(" ").map(e=>e.trim())),a=Qr.recompose(a,r,"prepend",l)}catch(e){console.error("[Inheritance error at source #"+n+"]: "+e.message)}return i.pop(),a}return i.pop(),a?a.cloneNode(!0):r?r.cloneNode(!0):null})}),customElements.define(Qr.elementMap.bundle,class extends HTMLTemplateElement{attributeChangedCallback(e,t,r){r&&this.load()}load(){var e=this.getAttribute("src");e&&this.content.children.length?console.warn("A CHTML bundle must define only either a remote content or local content! Bundle ignored."):e&&fetch(e).then(e=>e.ok?e.text():Promise.reject(e.statusText)).then(e=>{this.innerHTML=e,this.dispatchEvent(new Event("bundleloadsuccess"))}).catch(t=>{console.warn("Error fetching the bundle at "+e+". ("+t+")"),this.dispatchEvent(new Event("bundleloaderror"))})}static get observedAttributes(){return["src"]}},{extends:"template"}),customElements.define(Qr.elementMap.import,class extends HTMLElement{shouldResolve(){return!this.hasAttribute("ondemand")&&!this.closest("template")&&!this.closest(Qr.elementMap.import+"[ondemand]")}connectedCallback(){this.processed=!1,this.shouldResolve()&&this.resolve()}attributeChangedCallback(e,t,r){this.shouldResolve()&&this.resolve()}resolve(){Gr.ready(()=>{if(!this.parentNode)return!1;var e,t,r=Qr.attributeMap.ns;if((t=h(this.getAttribute(r)||"","//"))&&t!==this.__namespace)if(this.__namespace=t,e=Gr.import(t)){var n=Qr.recompose(this,e);this.hasAttribute("shadow")?(this.parentNode.shadowRoot||this.parentNode.attachShadow({mode:"open"}),this.parentNode.shadowRoot.append(n),this.remove()):this.replaceWith(n)}else this.innnerText='No element found on the namespace "'+t+'"!'})}static get observedAttributes(){return["ondemand",Qr.attributeMap.ns]}});var Jr=Gr;window.OnePhrase||(window.OnePhrase={}),window.OnePhrase.Chtml=Jr}]);
//# sourceMappingURL=main.js.map